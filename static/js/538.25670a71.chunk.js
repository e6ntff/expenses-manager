"use strict";(self.webpackChunkexpenses_manager=self.webpackChunkexpenses_manager||[]).push([[538],{8537:(e,t,a)=>{a.d(t,{Z:()=>j});var s=a(2791),r=a(7257),n=a(7201),o=a(4248),l=a(7708),i=a(4320),d=a(7892),c=a.n(d),u=a(9026),f=a.n(u),m=a(4895),g=a(4187),p=a(8807),y=a(5967),h=a(6619),v=a(3623),S=a(184);y.kL.register(y.u,y.jn,y.ST,y.uw,y.f$,y.od),c().extend(f());const x=(0,r.Pi)((e=>{let{range:t,defaultRange:a,setRange:r,setDefaultRange:d,isAccurate:u,setIsAccurate:f}=e;const{list:y}=i.listStore,{isSmallScreen:x}=p.userStore,[j,b]=(0,s.useState)(a),O=(0,s.useMemo)((()=>{var e,t;const a=y.map((e=>e.date));return[(null===(e=c().min(a))||void 0===e?void 0:e.valueOf())||0,(null===(t=c().max(a))||void 0===t?void 0:t.valueOf())||0]}),[y]),M=(0,s.useMemo)((()=>{const e=c()(O[0]).startOf("day"),t=c()(O[1]).endOf("day"),a={};let s=e;if(u)for(;s.isBefore(t)||s.isSame(t,"day");)a[s.valueOf()]=1===s.date()?0===s.month()?s.format("YYYY"):s.format("M"):" ",s=s.add(1,"day").startOf("day");else for(;s.isBefore(t)||s.isSame(t,"month");)a[s.valueOf()]=0===s.month()?s.format("YYYY"):" ",s=s.add(1,"month").startOf("month");return a}),[O,u]);(0,s.useEffect)((()=>{d(O)}),[O,d]),(0,s.useEffect)((()=>{r(a)}),[a,r]);const Z=(0,s.useCallback)((e=>{r(e)}),[r]);(0,s.useEffect)((()=>{b(t)}),[t]),(0,s.useEffect)((()=>{x&&f(!1)}),[x,f]),(0,s.useEffect)((()=>{!u&&r([c().max([c()(t[0]).startOf("month"),c()(a[0])]).valueOf(),c().min([c()(t[1]).endOf("month"),c()(a[1])]).valueOf()])}),[u]);const k=(0,s.useMemo)((()=>(0,h.BF)(y,a)),[y,a]),w={labels:new Array(k.length).fill(""),datasets:[{data:k}]};return c()(a[1]).diff(c()(a[0]),"hours")>=48?(0,S.jsxs)(n.Z,{gap:16,align:"center",children:[(0,S.jsx)(o.Z,{size:x?"small":"middle",defaultValue:u,value:u,onChange:f,options:[{label:(0,S.jsx)(m.Z,{}),value:!1},{label:(0,S.jsx)(g.Z,{}),value:!0,disabled:x}]}),(0,S.jsxs)(n.Z,{vertical:!0,align:"stretch",style:{inlineSize:"100%"},children:[(0,S.jsx)(v.x1,{data:w,options:{plugins:{legend:{display:!1},tooltip:{enabled:!1}},scales:{x:{display:!1,grid:{display:!1}},y:{display:!1,grid:{display:!1}}},elements:{point:{radius:0},line:{cubicInterpolationMode:"monotone",borderColor:"#7775"}},aspectRatio:25}}),(0,S.jsx)(l.Z,{range:!0,value:j,marks:M,step:null,dots:!0,tooltip:{formatter:e=>(0,S.jsx)(S.Fragment,{children:c()(e).format(u?"DD.MM.YY":"MM.YY")})},min:O[0],max:O[1],defaultValue:a,onChange:b,onChangeComplete:Z})]})]}):(0,S.jsx)(S.Fragment,{})})),j=(0,s.memo)(x)},538:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Y});var s=a(2791),r=a(7257),n=a(4320),o=a(5160),l=a(7201),i=a(3936),d=a(1429),c=a(2556),u=a(4664),f=a(8807),m=a(3623),g=a(8416),p=a(8418),y=a(7892),h=a.n(y),v=a(5967),S=a(6619),x=a(7703),j=a(184);v.kL.register(v.u,v.vn,v.ZL,v.uw,v.f$);const b=(0,r.Pi)((e=>{let{mode:t,setMode:a}=e;const{isSmallScreen:r}=f.userStore,{list:o}=n.listStore,{statsOptions:i,userOptions:d,setStatsRange:c}=x.optionsStore,{currency:u,language:y}=d,{range:v}=i,b=(0,s.useMemo)((()=>(0,S.u1)(o,u,t,h()(v[0]).year())),[u,o,t,v]),O={labels:"month"===t?g.Z.months[y]:Object.keys(b),datasets:[{label:(0,p.R)(u),data:Object.values(b),backgroundColor:"#f00"}]},M={plugins:{legend:{display:!1}},onClick:(e,s)=>{if(s.length){const e=s[0].index,r="year"===t?[h()(v[0]).year(Number(O.labels[e])).startOf("year").valueOf(),h()(v[0]).year(Number(O.labels[e])).endOf("year").valueOf()]:[h()(v[0]).month(e).startOf("month").valueOf(),h()(v[0]).month(e).endOf("month").valueOf()];"year"===t&&a("month"),c(r)}}};return(0,j.jsx)(l.Z,{style:{inlineSize:r?"unset":"50%"},children:(0,j.jsx)(m.$Q,{data:O,options:M})})}));var O=a(3475);v.kL.register(v.qi,v.tt,v.u,v.De,v.Dx);const M=(0,r.Pi)((()=>{const{isSmallScreen:e}=f.userStore,{list:t}=n.listStore,{userOptions:a,statsOptions:r}=x.optionsStore,{currency:o}=a,{getCategoryById:i}=O.categoryStore,{range:d,isAccurate:c}=r,u=(0,s.useMemo)((()=>(0,S.CH)(t,d,o,c,i)),[t,o,d,c,i]),[g,y,h]=[u.map((e=>e.category.name)),u.map((e=>e.category.color)),u.map((e=>Math.round(e.value)))],v={labels:g,datasets:[{label:(0,p.R)(o),data:h,backgroundColor:y}]};return(0,j.jsx)(l.Z,{style:{inlineSize:e?"unset":"40%"},children:(0,j.jsx)(m.by,{data:v,options:{plugins:{legend:{display:!0,position:"right"}}}})})}));var Z=a(3605),k=a(6818),w=a.n(k),E=a(8537),R=a(6281);h().extend(w());const C=(0,r.Pi)((()=>{const{list:e}=n.listStore,{isSmallScreen:t}=f.userStore,{statsOptions:a,userOptions:r,setStatsRange:m,setDefaultStatsRange:g,setIsStatsAccurate:y}=x.optionsStore,{currency:v}=r,{range:k,defaultRange:w,isAccurate:C}=a,[Y,D]=(0,s.useState)("year"),A=(0,s.useCallback)((()=>{D("year"),m(w)}),[D,w,m]);(0,s.useEffect)((()=>{const e=e=>{"Escape"===e.key&&A()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[A]);const B=(0,s.useMemo)((()=>k[0]!==w[0]||k[1]!==w[1]),[k,w]),I=(0,s.useMemo)((()=>{const e=C?"DD.MM.YY":"MM.YY";return(0,j.jsxs)(o.Z.Text,{type:"secondary",style:{fontSize:t?".8em":"1em"},children:[h()(k[0]).format(e),k[0]!==k[1]?"-".concat(h()(k[1]).format(e)):""]})}),[C,k,t]);(0,s.useEffect)((()=>{h()(k[0]).year()!==h()(k[1]).year()?D("year"):D("month")}),[k]);const z=(0,j.jsxs)(l.Z,{gap:16,children:[(0,j.jsx)(i.Z,{bordered:!0,children:(0,j.jsx)(d.Z,{title:I,value:(0,S.r6)(e,k,v,C),prefix:(0,p.R)(v),valueStyle:{color:"#f00",fontSize:t?"1em":"1.5em"}})}),(0,j.jsx)(c.ZP,{size:t?"small":"middle",onClick:A,disabled:!B,children:(0,j.jsx)(Z.Z,{})})]}),P=(0,j.jsxs)(l.Z,{vertical:!0,gap:16,align:"stretch",children:[(0,j.jsx)(E.Z,{setIsAccurate:y,isAccurate:C,range:k,defaultRange:w,setRange:m,setDefaultRange:g}),(0,j.jsxs)(l.Z,{align:"center",justify:"space-between",vertical:t,children:[(0,j.jsx)(b,{mode:Y,setMode:D}),(0,j.jsx)(M,{})]})]});return n.listStore.loading||O.categoryStore.loading?(0,j.jsx)(R.Z,{}):e.length?(0,j.jsxs)(l.Z,{vertical:!0,gap:32,children:[z,P]}):(0,j.jsx)(u.Z,{image:u.Z.PRESENTED_IMAGE_SIMPLE,description:""})})),Y=(0,s.memo)(C)},6619:(e,t,a)=>{a.d(t,{BF:()=>m,CH:()=>u,ky:()=>i,ls:()=>d,r6:()=>f,u1:()=>c});var s=a(8418),r=a(7892),n=a.n(r),o=a(6818),l=a.n(o);n().extend(l());const i=(e,t,a,r)=>{const{range:o,categoriesToFilter:l,sortingAlgorithm:i,isSortingReversed:d}=e;return(0,s.M)(t.filter((e=>l.length?e.date.isBetween(n()(o[0]),n()(o[1]),"day","[]")&&l.some((t=>e.categoryId===t.id)):e.date.isBetween(n()(o[0]),n()(o[1]),r?"day":"month","[]"))),i,d,a)},d=(e,t)=>{const{currentPage:a,pageSize:s}=e,r=(a-1)*s,n=r+s;return t.slice(r,n)},c=(e,t,a,s)=>{if("year"===a){const a={};e.forEach((e=>{const s=e.date.year();void 0===a[s]?a[s]=0:a[s]+=e.price[t]}));for(let e in a)a[e]=Math.round(a[e]);return a}if("month"===a){const a=new Array(12).fill(0);return e.forEach((e=>{if(e.date.year()===s){const s=e.date.month();a[s]+=e.price[t]}})),a.map((e=>Math.round(e)))}return[]},u=(e,t,a,s,r)=>{const o=[];return e.forEach((e=>{if(e.date.isBetween(n()(t[0]),n()(t[1]),s?"day":"month","[]")){const t=o.findIndex((t=>t.category.id===e.categoryId));-1!==t?o[t].value+=e.price[a]:o.push({category:r(e.categoryId),value:e.price[a]})}})),o.map((e=>({...e,value:Math.round(e.value)})))},f=(e,t,a,s)=>Math.floor(e.reduce(((e,r)=>r.date.isBetween(n()(t[0]),n()(t[1]),s?"hour":"day","()")?e+r.price[a]:e),0)),m=(e,t)=>{const a=[],s=n()(t[1]);let r=n()(t[0]),o=n()(t[0]).add(1,"month");for(;!o.isAfter(s,"day");){const t=e.filter((e=>e.date.isBetween(r,o,"day","[]"))).reduce(((e,t)=>e+t.price.USD),0);a.push(t),r=r.add(1,"month"),o=o.add(1,"month")}return a}},8418:(e,t,a)=>{a.d(t,{M:()=>r,R:()=>s});const s=(e,t)=>{var a;let s="";"USD"===e&&(s+="$"),"EUR"===e&&(s+="\u20ac"),"RUB"===e&&(s+="\u20bd");const r=null===(a=Math.round(t))||void 0===a?void 0:a.toString().split("").reverse().reduce(((e,t,a)=>a%3===0&&0!==a?[...e,t+","]:[...e,t]),[]).reverse().join("");return void 0===t?s:s+r},r=(e,t,a,s)=>{let r;switch(t){case"date":r=[...e].sort(((e,t)=>t.date.valueOf()-e.date.valueOf()));break;case"title":r=[...e].sort(((e,t)=>e.title.localeCompare(t.title,s,{sensitivity:"base"})));break;case"price":r=[...e].sort(((e,t)=>t.price.USD-e.price.USD));break;default:r=[...e]}return a?r.reverse():r}}}]);
//# sourceMappingURL=538.25670a71.chunk.js.map