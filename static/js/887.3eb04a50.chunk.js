"use strict";(self.webpackChunkexpenses_manager=self.webpackChunkexpenses_manager||[]).push([[887],{3556:(e,t,s)=>{s.d(t,{Z:()=>a});var n=s(126),r=s(7257),l=(s(2791),s(4554)),i=s(184);const a=(0,r.Pi)((e=>{let{value:t,onChange:s}=e;const{isSmallScreen:r}=l.userStore;return(0,i.jsxs)(n.Z,{size:r?"small":"middle",value:t,onChange:s,children:[(0,i.jsx)(n.Z.Option,{value:"USD",children:"USD"}),(0,i.jsx)(n.Z.Option,{value:"EUR",children:"EUR"}),(0,i.jsx)(n.Z.Option,{value:"RUB",children:"RUB"})]})}))},3598:(e,t,s)=>{s.d(t,{Z:()=>r});var n=s(2791);const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250;const[s,r]=(0,n.useState)(e);return(0,n.useEffect)((()=>{const s=setTimeout((()=>{r(e)}),t);return()=>{clearTimeout(s)}}),[e,t]),s}},1887:(e,t,s)=>{s.r(t),s.d(t,{default:()=>me});var n=s(2791),r=s(8418),l=s(6220),i=s(7201),a=s(5160),o=s(1429),c=s(952),d=s(4587),u=s(914),g=s(3936),h=s(7257),p=s(4320),m=s(4554),x=s(2499),S=s(732),j=s(2622),Z=s(1752),v=s(4878);const y=function(e,t){switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.Z.baseCurrency){case"USD":e.EUR=e.USD*t.EUR,e.RUB=e.USD*t.RUB;break;case"EUR":e.USD=e.EUR/t.EUR,e.RUB=e.EUR*t.RUB/t.EUR;break;case"RUB":e.EUR=e.RUB/t.RUB*t.EUR,e.USD=e.RUB/t.RUB}return e};var f=s(3475),C=s(8416),b=s(6005),R=s(8989),E=s(6203),U=s(3070),k=s(6106),z=s(3556),I=s(7892),M=s.n(I),P=s(126),O=s(8228),w=s(184);const D=(0,h.Pi)((e=>{let{value:t,onChange:s}=e;const{categories:n}=f.categoryStore,{isSmallScreen:r}=m.userStore;return(0,w.jsx)(P.Z,{size:r?"small":"middle",allowClear:!0,style:{minInlineSize:"7em"},onChange:s,value:null===t||void 0===t?void 0:t.id,suffixIcon:(0,w.jsx)(O.Z,{style:{color:null===t||void 0===t?void 0:t.color}}),children:n.map((e=>(0,w.jsx)(P.Z.Option,{value:e.id,children:e.name},e.id)))})}));var B=s(7575),T=s(7703);const F=(0,h.Pi)((e=>{let{opened:t,initialItem:s,toggleOpened:r,submitItem:l}=e;const[i,a]=(0,n.useState)(v.Z.baseCurrency),{categories:o}=f.categoryStore,{currencyRates:c,isSmallScreen:d}=m.userStore,{userOptions:g}=T.optionsStore,{language:h}=g,[p,x]=(0,n.useState)(s),j=(0,n.useCallback)((e=>{const{value:t}=e.target;x((e=>({...e,title:t})))}),[x]),Z=(0,n.useCallback)((e=>{e&&x((t=>({...t,date:e})))}),[x]),I=(0,n.useCallback)((e=>{const t=o.find((t=>t.id===e));x((e=>({...e,category:t||e.category})))}),[x,o]),P=(0,n.useCallback)((e=>{const{value:t}=e.target;x((e=>{const s={...e,price:{...e.price,[i]:Number(t)}};return{...s,price:y(s.price,c,i)}}))}),[x,i,c]);(0,n.useEffect)((()=>{const e=s=>{"Enter"===s.key&&t&&(l(p),window.removeEventListener("keyup",e))};return window.addEventListener("keyup",e),()=>{window.removeEventListener("keyup",e)}}),[p,l,t]);const O=(0,w.jsx)(b.Z,{required:!0,type:"text",value:p.title,onInput:j}),F=(0,w.jsx)(b.Z,{required:!0,type:"number",min:"1",step:"1",value:Math.round(p.price[i]),onInput:P}),A=(0,w.jsx)(z.Z,{value:i,setCurrency:a,onChange:a}),L=(0,w.jsx)(R.Z,{required:!0,onChange:Z,value:p.date,minDate:v.Z.startDate,maxDate:M()()}),N=(0,w.jsx)(D,{value:p.category,onChange:I});return(0,w.jsx)(E.Z,{style:{inlineSize:""},open:t,okButtonProps:{size:d?"small":"middle"},cancelButtonProps:{size:d?"small":"middle"},onOk:()=>{l(p)},onCancel:()=>{x(s),r()},okText:(0,w.jsx)(B.Z,{}),cancelText:(0,w.jsx)(S.Z,{}),children:(0,w.jsxs)(U.Z,{size:d?"small":"middle",layout:"vertical",style:{inlineSize:"100%"},children:[(0,w.jsx)(U.Z.Item,{label:C.Z.title[h],children:O}),(0,w.jsx)(U.Z.Item,{label:C.Z.price[h],children:(0,w.jsxs)(k.Z,{children:[(0,w.jsx)(u.Z,{span:16,children:F}),(0,w.jsx)(u.Z,{span:1}),(0,w.jsx)(u.Z,{span:7,children:A})]})}),(0,w.jsx)(U.Z.Item,{label:C.Z.dateAndCat[h],children:(0,w.jsxs)(k.Z,{children:[(0,w.jsx)(u.Z,{span:10,children:L}),(0,w.jsx)(u.Z,{span:1}),(0,w.jsx)(u.Z,{span:13,children:N})]})})]})})})),A=(0,h.Pi)((e=>{let{mode:t,initialItem:s}=e;const{id:h,category:y,date:f,title:b,price:R}=s,{isSmallScreen:E}=m.userStore,{replaceItem:U,removeItem:k}=p.listStore,{userOptions:z}=T.optionsStore,{currency:I,language:M}=z,[P,O]=(0,n.useState)(!1),[D,B]=(0,n.useState)(0),[A,L]=(0,n.useState)(!1),[N,_]=(0,n.useState)({id:h,date:f,title:b,category:y,price:R}),q=()=>{O((e=>!e))};(0,n.useEffect)((()=>{const e=setInterval((()=>{B((e=>{const t=e+10;return t>=v.Z.deleteDelay&&P&&k(N),t}))}),10);return P||(clearInterval(e),B(0)),()=>clearInterval(e)}),[P,N,k]);const Y=(0,n.useCallback)((()=>{L((e=>!e))}),[L]),W=(0,n.useCallback)((e=>{_(e),U(e),Y()}),[_,U,Y]),G=(0,w.jsx)(i.Z,{justify:"center",style:{opacity:P||!N.title?".5":"1"},children:E?(0,w.jsx)(a.Z.Text,{strong:!0,ellipsis:!0,children:N.title||C.Z.noTitle[M]}):(0,w.jsx)(x.Z,{ellipsis:!0,level:3,style:{margin:0},children:N.title||C.Z.noTitle[M]})}),H=(0,w.jsx)(o.Z,{value:N.date.format("DD.MM.YY"),style:{scale:E?".75":"1",opacity:P?".5":"1"}}),X=(0,w.jsx)(i.Z,{vertical:!0,align:"stretch",style:{opacity:P?".5":"1"},children:(0,w.jsx)(c.Z,{color:N.category.color,children:(0,w.jsx)("span",{style:{margin:"auto",color:N.category.color,filter:"invert(1)"},children:N.category.name})})}),$=(0,w.jsx)(i.Z,{justify:"center",style:{opacity:P?".5":"1"},children:E?(0,w.jsxs)(a.Z.Text,{strong:!0,children:[(0,r.R)(I),Math.round(N.price[I])]}):(0,w.jsx)(x.Z,{level:3,style:{margin:0},children:(0,r.R)(I,N.price[I])})}),J=P?(0,w.jsx)(S.Z,{onClick:q,style:{scale:E?"1":"1.5"}}):(0,w.jsx)(j.Z,{onClick:q,style:{scale:E?"1":"1.5"}}),K=(0,w.jsx)(d.Z,{showInfo:!1,percent:D/v.Z.deleteDelay*100,status:"exception"}),Q=(0,w.jsx)(Z.Z,{onClick:P?()=>{}:()=>W({...s}),style:{scale:E?"1":"1.5"}}),V=(0,w.jsxs)(i.Z,{justify:"space-evenly",children:[Q,$,J]});return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(F,{opened:A,initialItem:N,toggleOpened:Y,submitItem:W}),"list"===t?(0,w.jsx)(l.Z,{children:P?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(u.Z,{span:21,children:K}),(0,w.jsx)(u.Z,{children:J})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(u.Z,{children:H}),(0,w.jsx)(u.Z,{span:9,children:G}),(0,w.jsx)(u.Z,{span:3,children:X}),(0,w.jsx)(u.Z,{span:5,children:$}),(0,w.jsx)(u.Z,{children:Q}),(0,w.jsx)(u.Z,{children:J})]})}):(0,w.jsx)(g.Z,{size:E?"small":"default",bordered:!0,title:P?K:G,actions:[V],children:(0,w.jsx)(i.Z,{justify:"center",children:(0,w.jsxs)(i.Z,{vertical:!0,align:"stretch",gap:4,children:[H,X]})})})]})}));var L=s(43),N=s(4664),_=s(6051),q=s(6619),Y=s(3598);const W=(0,h.Pi)((e=>{let{filteredList:t}=e;const{loading:s}=p.listStore,{width:r}=m.userStore,{listOptions:l}=T.optionsStore,i=(0,Y.Z)(l),[a,o]=(0,n.useState)(4);(0,n.useEffect)((()=>{o(r<350?1:r<450?2:r<850?3:4)}),[o,r]);const c=(0,n.useMemo)((()=>(0,q.ls)(i,t)),[t,i]),d=(0,n.useMemo)((()=>{const e=[];let t=-1;return c.forEach(((s,n)=>{n%a===0&&(t++,e.push([])),e[t].push(s)})),e}),[a,c]);return(0,w.jsxs)(w.Fragment,{children:[s?(0,w.jsx)(L.Z,{}):!t.length&&(0,w.jsx)(N.Z,{image:N.Z.PRESENTED_IMAGE_SIMPLE,description:""}),"list"===i.mode?(0,w.jsx)(_.Z,{style:{inlineSize:"100%"},children:c.map((e=>(0,w.jsx)(A,{mode:i.mode,initialItem:e},e.id)))}):d.map((e=>(0,w.jsx)(k.Z,{gutter:16,style:{inlineSize:"100%"},children:e.map((e=>(0,w.jsx)(u.Z,{span:24/a,children:(0,w.jsx)(A,{mode:i.mode,initialItem:e})},e.id)))},e[0].id)))]})})),G=(0,n.memo)(W);var H=s(2556),X=s(7128),$=s(6834),J=s(9286);const K=(0,h.Pi)((()=>{const{addItem:e}=p.listStore,{isSmallScreen:t}=m.userStore,s=(0,n.useMemo)((()=>v.Z.emptyItem),[]),[r,l]=(0,n.useState)(s),[i,a]=(0,n.useState)(!1),o=(0,n.useCallback)((()=>{a((e=>!e))}),[a]),c=(0,n.useCallback)((()=>{l(s)}),[l,s]),d=(0,n.useCallback)((t=>{e(t),c(),o()}),[e,o,c]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(H.ZP,{onClick:o,size:t?"small":"middle",children:(0,w.jsx)(J.Z,{})}),(0,w.jsx)(F,{opened:i,initialItem:r,toggleOpened:o,submitItem:d})]})}));var Q=s(50);const V=(0,h.Pi)((()=>{const{list:e}=p.listStore,{isSmallScreen:t}=m.userStore,{listOptions:s,handleYearChanging:r}=T.optionsStore,l=(0,n.useMemo)((()=>e.reduce(((e,t)=>{const s=t.date.year().toString();return e.find((e=>e===s))?e:[...e,s]}),[]).sort(((e,t)=>Number(e)-Number(t)))),[e]);return(0,w.jsxs)(i.Z,{gap:8,style:{alignSelf:"start"},children:[(0,w.jsx)(P.Z,{size:t?"small":"middle",mode:"multiple",showSearch:!1,value:s.years,onChange:r,style:{minInlineSize:"7em"},children:l.reverse().map((e=>(0,w.jsx)(P.Z.Option,{value:e,children:e},e)))}),(0,w.jsx)(Q.Z,{style:{opacity:.5}})]})})),ee=V,te=(0,h.Pi)((()=>{const{categories:e}=f.categoryStore,{isSmallScreen:t}=m.userStore,{listOptions:s,handleCategoriesToFilterChange:n}=T.optionsStore;return(0,w.jsx)(P.Z,{size:t?"small":"middle",mode:"multiple",showSearch:!1,tagRender:t=>((e,t)=>{var s;const{label:n,value:r,onClose:l}=e,i=null===(s=t.find((e=>e.id===r)))||void 0===s?void 0:s.color;return(0,w.jsx)(c.Z,{color:i,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},closable:!0,onClose:l,style:{marginInlineEnd:4},children:(0,w.jsx)("span",{style:{color:i,filter:"invert(1)"},children:n})})})(t,e),style:{minInlineSize:"10em"},value:s.categoriesToFilter.map((e=>e.id)),onChange:n,children:e.map((e=>(0,w.jsx)(P.Z.Option,{value:e.id,children:e.name},e.id)))})}));var se=s(4248),ne=s(4544),re=s(54),le=s(9168),ie=s(2785),ae=s(897);const oe=(0,h.Pi)((()=>{const{isSmallScreen:e}=m.userStore,{setIsSortingReversed:t,listOptions:s,handleSortAlgorithmChanging:n}=T.optionsStore;return(0,w.jsxs)(i.Z,{gap:8,style:{alignSelf:"start"},children:[s.isSortingReversed?(0,w.jsx)(ne.Z,{}):(0,w.jsx)(re.Z,{}),(0,w.jsx)(se.Z,{size:e?"small":"middle",value:s.sortingAlgorithm,onDoubleClick:()=>t(!s.isSortingReversed),onChange:n,options:[{label:(0,w.jsx)(le.Z,{}),value:"date"},{label:(0,w.jsx)(ie.Z,{}),value:"title"},{label:(0,w.jsx)(ae.Z,{}),value:"price"}]})]})}));var ce=s(6324),de=s(9197);const ue=(0,h.Pi)((()=>{const{isSmallScreen:e}=m.userStore,{listOptions:t,handleModeChanging:s}=T.optionsStore;return(0,w.jsx)(i.Z,{gap:8,style:{alignSelf:"start"},children:(0,w.jsx)(se.Z,{size:e?"small":"middle",value:t.mode,onChange:s,options:[{label:(0,w.jsx)(ce.Z,{}),value:"list",disabled:e},{label:(0,w.jsx)(de.Z,{}),value:"grid"}]})})}));var ge=s(3605);const he=(0,h.Pi)((e=>{let{total:t}=e;const{loading:s}=p.listStore,{isSmallScreen:r}=m.userStore,{listOptions:l,resetSettings:a,handlePageChanging:o}=T.optionsStore,c=(0,n.useMemo)((()=>l.isSortingReversed||l.years.length>0||l.categoriesToFilter.length>0||l.pageSize!==v.Z.defaultPageSize||1!==l.currentPage||"date"!==l.sortingAlgorithm),[l]);return(0,w.jsxs)(i.Z,{style:{inlineSize:"100%"},vertical:!0,gap:16,children:[(0,w.jsxs)(i.Z,{style:{inlineSize:"100%"},gap:16,vertical:r,children:[(0,w.jsxs)(i.Z,{gap:16,children:[(0,w.jsx)(K,{}),(0,w.jsx)(ee,{}),(0,w.jsx)(te,{})]}),(0,w.jsxs)(i.Z,{gap:16,children:[(0,w.jsx)(oe,{}),(0,w.jsx)(ue,{}),c&&(0,w.jsx)(H.ZP,{onClick:a,size:r?"small":"middle",children:(0,w.jsx)(ge.Z,{})})]})]}),(0,w.jsx)(X.Z,{}),!s&&(0,w.jsx)($.Z,{style:{alignSelf:"center"},size:r?"small":"default",showSizeChanger:!0,pageSizeOptions:v.Z.pageSizeOptions,current:l.currentPage,pageSize:l.pageSize,total:t,onChange:o,onShowSizeChange:o})]})})),pe=(0,h.Pi)((()=>{const{isSmallScreen:e}=m.userStore,{list:t}=p.listStore,{listOptions:s,userOptions:r,handleModeChanging:l,handlePageChanging:a}=T.optionsStore,{language:o}=r;(0,n.useEffect)((()=>{e&&l("grid")}),[e,l]),(0,n.useEffect)((()=>{a(1,s.pageSize)}),[s.years,s.sortingAlgorithm,s.isSortingReversed,s.categoriesToFilter,s.pageSize,a]);const c=(0,n.useMemo)((()=>(0,q.ky)(s,t,o)),[t,o,s]);return(0,w.jsxs)(i.Z,{vertical:!0,gap:16,align:"center",children:[(0,w.jsx)(he,{total:c.length}),(0,w.jsx)(G,{filteredList:c})]})})),me=pe},6619:(e,t,s)=>{s.d(t,{MF:()=>a,W3:()=>o,Wu:()=>d,X2:()=>u,ky:()=>r,ls:()=>l,nH:()=>i,wF:()=>c});var n=s(8418);const r=(e,t,s)=>{const{years:r,categoriesToFilter:l,sortingAlgorithm:i,isSortingReversed:a}=e;return r||l?(0,n.M)(t.filter((e=>!l.length&&r.length?r.some((t=>e.date.year().toString()===t)):!r.length&&l.length?l.some((t=>e.category.id===t.id)):r.length&&l.length?r.some((t=>e.date.year().toString()===t))&&l.some((t=>e.category.id===t.id)):e)),i,a,s):(0,n.M)(t,i,a,s)},l=(e,t)=>{const{currentPage:s,pageSize:n}=e,r=(s-1)*n,l=r+n;return t.slice(r,l)},i=(e,t,s,n,r)=>{const l=new Array(void 0===r?12:31).fill(0);return e.forEach((e=>{void 0===r?e.date.year()===s&&(l[e.date.month()]+=e.price[t]):e.date.year()===s&&e.date.month()===n&&(l[e.date.date()]+=e.price[t])}),[]),l.map((e=>Math.round(e)))},a=(e,t)=>{const s={};e.forEach((e=>{const n=e.date.year().toString();void 0===s[n]?s[n]=0:s[n]+=e.price[t]}));for(let n in s)s[n]=Math.round(s[n]);return s},o=(e,t,s)=>{const n=new Array(12).fill(0);return e.forEach((e=>{if(e.date.year()===t){const t=e.date.month();n[t]+=e.price[s]}})),n.map((e=>Math.round(e)))},c=(e,t)=>{const s=[];return e.forEach((e=>{const n=s.findIndex((t=>t.category.id===e.category.id));-1!==n?s[n].value+=e.price[t]:s.push({category:e.category,value:e.price[t]})})),s.map((e=>({...e,value:Math.round(e.value)})))},d=(e,t,s,n)=>{const r=[];return e.forEach((e=>{const l=r.findIndex((t=>t.category.id===e.category.id));e.date.year()!==t||null!==s&&e.date.month()!==s||(-1!==l?r[l].value+=e.price[n]:r.push({category:e.category,value:e.price[n]}))})),r.map((e=>({...e,value:Math.round(e.value)})))},u=(e,t,s,n,r)=>{const l=[];return e.forEach((e=>{const i=l.findIndex((t=>t.category.id===e.category.id));e.date.date()===n&&e.date.month()===s&&e.date.year()===t&&(-1!==i?l[i].value+=e.price[r]:l.push({category:e.category,value:e.price[r]}))})),l.map((e=>({...e,value:Math.round(e.value)})))}},8418:(e,t,s)=>{s.d(t,{M:()=>r,R:()=>n});const n=(e,t)=>{var s;let n="";"USD"===e&&(n+="$"),"EUR"===e&&(n+="\u20ac"),"RUB"===e&&(n+="\u20bd");const r=null===(s=Math.round(t))||void 0===s?void 0:s.toString().split("").reverse().reduce(((e,t,s)=>s%3===0&&0!==s?[...e,t+","]:[...e,t]),[]).reverse().join("");return void 0===t?n:n+r},r=(e,t,s,n)=>{let r;switch(t){case"date":r=[...e].sort(((e,t)=>t.date.valueOf()-e.date.valueOf()));break;case"title":r=[...e].sort(((e,t)=>e.title.localeCompare(t.title,n,{sensitivity:"base"})));break;case"price":r=[...e].sort(((e,t)=>t.price.USD-e.price.USD));break;default:r=[...e]}return s?r.reverse():r}}}]);
//# sourceMappingURL=887.3eb04a50.chunk.js.map