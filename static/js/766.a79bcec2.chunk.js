"use strict";(self.webpackChunkexpenses_manager=self.webpackChunkexpenses_manager||[]).push([[766],{3932:(e,t,s)=>{s.d(t,{Z:()=>u});var a=s(3605),r=s(4231),n=s(2556),o=s(7257),l=(s(2791),s(8416)),i=s(7703),c=s(8807),d=s(184);const u=(0,o.Pi)((e=>{let{disabled:t,reset:s}=e;const{userOptions:o}=i.optionsStore,{isSmallScreen:u}=c.userStore;return(0,d.jsx)(r.Z,{title:l.Z.reset[o.language],children:(0,d.jsx)(n.ZP,{disabled:t,onClick:s,size:u?"small":"middle",children:(0,d.jsx)(a.Z,{})})})}))},2158:(e,t,s)=>{s.d(t,{Z:()=>k});var a=s(2791),r=s(7257),n=s(4520),o=s(4248),l=s(4231),i=s(7708),c=s(4320),d=s(7892),u=s.n(d),m=s(9026),f=s.n(m),g=s(4895),h=s(4187),p=s(8807),y=s(5967),S=s(3623),v=s(7703),j=s(6619),x=s(184);const b=(0,r.Pi)((()=>{const{list:e}=c.listStore,{defaultRange:t}=v.optionsStore,s=(0,a.useMemo)((()=>(0,j.BF)(e,t)),[e,t]),r={labels:new Array(s.length).fill(""),datasets:[{data:s}]};return(0,x.jsx)(S.x1,{style:{inlineSize:"100%"},data:r,options:{plugins:{legend:{display:!1},tooltip:{enabled:!1}},scales:{x:{display:!1,grid:{display:!1}},y:{display:!1,grid:{display:!1}}},elements:{point:{radius:0},line:{cubicInterpolationMode:"monotone",borderColor:"#7775"}},aspectRatio:25}})})),O=(0,a.memo)(b);var M=s(8416);y.kL.register(y.u,y.jn,y.ST,y.uw,y.f$,y.od),u().extend(f());const Z=(0,r.Pi)((e=>{let{range:t,setRange:s,isAccurate:r,setIsAccurate:d}=e;const{list:m}=c.listStore,{isSmallScreen:f}=p.userStore,{defaultRange:y,setDefaultRange:S,userOptions:j}=v.optionsStore,[b,Z]=(0,a.useState)(y),k=(0,a.useMemo)((()=>{const e=Object.values(m).map((e=>e.date));return[Math.min(...e),Math.max(...e)]}),[m]),E=(0,a.useMemo)((()=>{const e=u()(k[0]).startOf("day"),t=u()(k[1]).endOf("day"),s={};let a=e;if(r)for(;a.isBefore(t)||a.isSame(t,"day");)s[a.valueOf()]=1===a.date()?0===a.month()?a.format("YYYY"):a.format("M"):" ",a=a.add(1,"day").startOf("day");else for(;a.isBefore(t)||a.isSame(t,"month");)s[a.valueOf()]=0===a.month()?a.format("YYYY"):" ",a=a.add(1,"month").startOf("month");return s}),[k,r]);(0,a.useEffect)((()=>{S(k)}),[k,S]),(0,a.useEffect)((()=>{s(y)}),[y,s]);const R=(0,a.useCallback)((e=>{s(e)}),[s]);return(0,a.useEffect)((()=>{Z(t)}),[t]),(0,a.useEffect)((()=>{f&&d(!1)}),[f,d]),(0,a.useEffect)((()=>{!r&&s([u().max([u()(t[0]).startOf("month"),u()(y[0])]).valueOf(),u().min([u()(t[1]).endOf("month"),u()(y[1])]).valueOf()])}),[r]),u()(y[1]).diff(u()(y[0]),"hours")>=48?(0,x.jsxs)(n.Z,{gap:16,align:"center",children:[(0,x.jsx)(o.Z,{size:f?"small":"middle",defaultValue:r,value:r,onChange:d,options:[{label:(0,x.jsx)(l.Z,{title:M.Z.byMonth[j.language],children:(0,x.jsx)(g.Z,{})}),value:!1},{label:(0,x.jsx)(l.Z,{title:M.Z.byDay[j.language],children:(0,x.jsx)(h.Z,{})}),value:!0,disabled:f}]}),(0,x.jsxs)(n.Z,{vertical:!0,align:"stretch",style:{inlineSize:"100%"},children:[(0,x.jsx)(O,{}),(0,x.jsx)(i.Z,{range:!0,value:b,marks:E,step:null,dots:!0,tooltip:{formatter:e=>(0,x.jsx)(x.Fragment,{children:u()(e).format(r?"DD.MM.YY":"MM.YY")})},min:k[0],max:k[1],defaultValue:y,onChange:Z,onChangeComplete:R})]})]}):(0,x.jsx)(x.Fragment,{})})),k=(0,a.memo)(Z)},9766:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Y});var a=s(2791),r=s(7257),n=s(4320),o=s(4520),l=s(4664),i=s(8807),c=s(3623),d=s(8416),u=s(8418),m=s(7892),f=s.n(m),g=s(5967),h=s(6619),p=s(7703),y=s(184);g.kL.register(g.u,g.vn,g.ZL,g.uw,g.f$);const S=(0,r.Pi)((e=>{let{mode:t,setMode:s}=e;const{isSmallScreen:r}=i.userStore,{list:l}=n.listStore,{statsOptions:m,userOptions:g,setStatsRange:S}=p.optionsStore,{currency:v,language:j}=g,{range:x}=m,b=(0,a.useMemo)((()=>(0,h.u1)(l,v,t,f()(x[0]).year())),[v,l,t,x]),O=(0,a.useMemo)((()=>"year"===t?Object.keys(b).map((e=>{const t=f()(e);return t>=f()(x[0]).startOf("year")&&t<=f()(x[1]).endOf("year")?"#f00":"#f007"})):Object.keys(b).map((e=>{const t=Number(e);return t>=f()(x[0]).startOf("month").month()&&t<=f()(x[1]).endOf("month").month()?"#f00":"#f005"}))),[x,b,t]),M={labels:"month"===t?d.Z.months[j]:Object.keys(b),datasets:[{label:(0,u.Rh)(v),data:Object.values(b),backgroundColor:O}]},Z={plugins:{legend:{display:!1}},onClick:(e,a)=>{if(a.length){const e=a[0].index,r="year"===t?[f()(x[0]).year(Number(M.labels[e])).startOf("year").valueOf(),f()(x[0]).year(Number(M.labels[e])).endOf("year").valueOf()]:[f()(x[0]).month(e).startOf("month").valueOf(),f()(x[0]).month(e).endOf("month").valueOf()];"year"===t&&s("month"),S(r)}}};return(0,y.jsx)(o.Z,{style:{inlineSize:r?"unset":"50%"},children:(0,y.jsx)(c.$Q,{data:M,options:Z})})}));var v=s(3475);g.kL.register(g.qi,g.tt,g.u,g.De,g.Dx);const j=(0,r.Pi)((()=>{const{isSmallScreen:e}=i.userStore,{list:t}=n.listStore,{userOptions:s,statsOptions:r}=p.optionsStore,{currency:l}=s,{categories:d}=v.categoryStore,{range:m}=r,f=(0,a.useMemo)((()=>(0,h.CH)(t,m,l)),[t,l,m]),[g,S,j]=[f.map((e=>d[e.categoryId].name)),f.map((e=>d[e.categoryId].color)),f.map((e=>Math.round(e.value)))],x={labels:g,datasets:[{label:(0,u.Rh)(l),data:j,backgroundColor:S}]};return(0,y.jsx)(o.Z,{style:{inlineSize:e?"unset":"40%"},children:(0,y.jsx)(c.by,{data:x,options:{plugins:{legend:{display:!0,position:"right"}}}})})}));var x=s(6818),b=s.n(x),O=s(2158),M=s(6281),Z=s(5160),k=s(3936),E=s(1429);const R=(0,r.Pi)((()=>{const{isSmallScreen:e}=i.userStore,{list:t}=n.listStore,{statsOptions:s,userOptions:r}=p.optionsStore,{range:o,isAccurate:l}=s,{currency:c}=r,d=(0,a.useMemo)((()=>(0,h.r6)(t,o,c)),[t,o,c]),m=(0,a.useMemo)((()=>{const t=l?"DD.MM.YY":"MM.YY";return(0,y.jsxs)(Z.Z.Text,{type:"secondary",style:{fontSize:e?".8em":"1em"},children:[f()(o[0]).format(t),o[0]!==o[1]?"-".concat(f()(o[1]).format(t)):""]})}),[l,o,e]);return(0,y.jsx)(k.Z,{bordered:!0,children:(0,y.jsx)(E.Z,{title:m,value:d,prefix:(0,u.Rh)(c),valueStyle:{color:"#f00",fontSize:e?"1em":"1.5em"}})})})),w=(0,a.memo)(R);var C=s(3932);f().extend(b());const I=(0,r.Pi)((()=>{const{list:e}=n.listStore,{isSmallScreen:t,loading:s}=i.userStore,{statsOptions:r,defaultRange:c,setStatsRange:d,setIsStatsAccurate:u}=p.optionsStore,{range:m,isAccurate:g}=r,[h,v]=(0,a.useState)("year"),x=(0,a.useCallback)((()=>{v("year"),d(c)}),[v,c,d]);(0,a.useEffect)((()=>{const e=e=>{"Escape"===e.key&&x()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[x]);const b=(0,a.useMemo)((()=>m[0]!==c[0]||m[1]!==c[1]),[m,c]);(0,a.useEffect)((()=>{f()(m[0]).year()!==f()(m[1]).year()?v("year"):v("month")}),[m]);const Z=(0,y.jsxs)(o.Z,{gap:16,children:[(0,y.jsx)(w,{}),(0,y.jsx)(C.Z,{reset:x,disabled:!b})]}),k=(0,y.jsxs)(o.Z,{vertical:!0,gap:16,align:"stretch",children:[(0,y.jsx)(O.Z,{setIsAccurate:u,isAccurate:g,range:m,setRange:d}),(0,y.jsxs)(o.Z,{align:"center",justify:"space-between",vertical:t,children:[(0,y.jsx)(S,{mode:h,setMode:v}),(0,y.jsx)(j,{})]})]});return s?(0,y.jsx)(M.Z,{}):Object.keys(e).length?(0,y.jsxs)(o.Z,{vertical:!0,gap:32,children:[Z,k]}):(0,y.jsx)(l.Z,{image:l.Z.PRESENTED_IMAGE_SIMPLE,description:""})})),Y=(0,a.memo)(I)},6619:(e,t,s)=>{s.d(t,{BF:()=>f,CH:()=>u,W2:()=>c,r6:()=>m,tL:()=>i,u1:()=>d});var a=s(8418),r=s(7892),n=s.n(r),o=s(6818),l=s.n(o);n().extend(l());const i=(e,t,s)=>{const{range:r,categoriesToFilterIds:n,sortingAlgorithm:o,isSortingReversed:l}=e;return(0,a.MR)(t,Object.keys(t).filter((e=>!t[e].deleted&&t[e].date>=r[0]&&t[e].date<=r[1]&&(!n.length||n.some((s=>t[e].categoryId===s))))),o,l,s)},c=(e,t)=>{const{currentPage:s,pageSize:a}=e,r=(s-1)*a,n=r+a;return t.slice(r,n)},d=(e,t,s,a)=>{if("year"===s){const s={};Object.keys(e).forEach((a=>{const r=n()(e[a].date).year();void 0===s[r]?s[r]=e[a].price[t]:s[r]+=e[a].price[t]}));for(let e in s)s[e]=Math.round(s[e]);return s}if("month"===s){const s=new Array(12).fill(0);return Object.keys(e).forEach((r=>{if(n()(e[r].date).year()===a){const a=n()(e[r].date).month();s[a]+=e[r].price[t]}})),s.map((e=>Math.round(e)))}return[]},u=(e,t,s)=>{const a=[];return Object.keys(e).forEach((r=>{if(e[r].date>t[0]&&e[r].date<t[1]){const t=Object.keys(a).findIndex((t=>a[Number(t)].categoryId===e[r].categoryId));-1!==t?a[t].value+=e[r].price[s]:a.push({categoryId:e[r].categoryId,value:e[r].price[s]})}})),a.map((e=>({...e,value:Math.round(e.value)})))},m=(e,t,s)=>Math.floor(Object.values(e).reduce(((e,a)=>a.date>=t[0]&&a.date<=t[1]?e+a.price[s]:e),0)),f=(e,t)=>{const s=[],a=n()(t[1]);let r=n()(t[0]),o=n()(t[0]).add(1,"month");for(;!o.isAfter(a,"day");){const t=Object.values(e).filter((e=>e.date>r.valueOf()&&e.date<o.valueOf())).reduce(((e,t)=>e+t.price.USD),0);s.push(t),r=r.add(1,"month"),o=o.add(1,"month")}return s}},8418:(e,t,s)=>{s.d(t,{MR:()=>r,Rh:()=>a,u:()=>n});const a=(e,t)=>{var s;let a="";"USD"===e&&(a+="$"),"EUR"===e&&(a+="\u20ac"),"RUB"===e&&(a+="\u20bd");const r=null===(s=Math.round(t))||void 0===s?void 0:s.toString().split("").reverse().reduce(((e,t,s)=>s%3===0&&0!==s?[...e,t+","]:[...e,t]),[]).reverse().join("");return void 0===t?a:a+r},r=(e,t,s,a,r)=>{let n;switch(s){case"date":n=t.sort(((t,s)=>e[s].date.valueOf()-e[t].date.valueOf()));break;case"title":n=t.sort(((t,s)=>e[t].title.localeCompare(e[s].title,r,{sensitivity:"base"})));break;case"price":n=t.sort(((t,s)=>e[s].price.USD-e[t].price.USD));break;default:n=t}return a?n.reverse():n},n=(e,t)=>new Promise((s=>{const a=new Image;a.src=e,a.onload=()=>{const e=document.createElement("canvas"),r=e.getContext("2d");e.width=a.width,e.height=a.height,null===r||void 0===r||r.drawImage(a,0,0);const n=e.toDataURL("image/jpeg",t);s(n)}}))}}]);
//# sourceMappingURL=766.a79bcec2.chunk.js.map