"use strict";(self.webpackChunkexpenses_manager=self.webpackChunkexpenses_manager||[]).push([[781],{8537:(e,t,s)=>{s.d(t,{Z:()=>v});var n=s(2791),r=s(7257),a=s(7201),l=s(4248),i=s(7708),o=s(4320),c=s(7892),d=s.n(c),u=s(9026),g=s.n(u),m=s(4895),h=s(4187),p=s(8807),x=s(5967),j=s(6619),S=s(3623),f=s(184);x.kL.register(x.u,x.jn,x.ST,x.uw,x.f$,x.od),d().extend(g());const Z=(0,r.Pi)((e=>{let{range:t,defaultRange:s,setRange:r,setDefaultRange:c,isAccurate:u,setIsAccurate:g}=e;const{list:x}=o.listStore,{isSmallScreen:Z}=p.userStore,[v,y]=(0,n.useState)(s),C=(0,n.useMemo)((()=>{var e,t;const s=x.map((e=>e.date));return[(null===(e=d().min(s))||void 0===e?void 0:e.valueOf())||0,(null===(t=d().max(s))||void 0===t?void 0:t.valueOf())||0]}),[x]),b=(0,n.useMemo)((()=>{const e=d()(C[0]).startOf("day"),t=d()(C[1]).endOf("day"),s={};let n=e;if(u)for(;n.isBefore(t)||n.isSame(t,"day");)s[n.valueOf()]=1===n.date()?0===n.month()?n.format("YYYY"):n.format("M"):" ",n=n.add(1,"day").startOf("day");else for(;n.isBefore(t)||n.isSame(t,"month");)s[n.valueOf()]=0===n.month()?n.format("YYYY"):" ",n=n.add(1,"month").startOf("month");return s}),[C,u]);(0,n.useEffect)((()=>{c(C)}),[C,c]),(0,n.useEffect)((()=>{r(s)}),[s,r]);const I=(0,n.useCallback)((e=>{r(e)}),[r]);(0,n.useEffect)((()=>{y(t)}),[t]),(0,n.useEffect)((()=>{Z&&g(!1)}),[Z,g]),(0,n.useEffect)((()=>{!u&&r([d().max([d()(t[0]).startOf("month"),d()(s[0])]).valueOf(),d().min([d()(t[1]).endOf("month"),d()(s[1])]).valueOf()])}),[u]);const R=(0,n.useMemo)((()=>(0,j.BF)(x,s)),[x,s]),k={labels:new Array(R.length).fill(""),datasets:[{data:R}]};return d()(s[1]).diff(d()(s[0]),"hours")>=48?(0,f.jsxs)(a.Z,{gap:16,align:"center",children:[(0,f.jsx)(l.Z,{size:Z?"small":"middle",defaultValue:u,value:u,onChange:g,options:[{label:(0,f.jsx)(m.Z,{}),value:!1},{label:(0,f.jsx)(h.Z,{}),value:!0,disabled:Z}]}),(0,f.jsxs)(a.Z,{vertical:!0,align:"stretch",style:{inlineSize:"100%"},children:[(0,f.jsx)(S.x1,{data:k,options:{plugins:{legend:{display:!1},tooltip:{enabled:!1}},scales:{x:{display:!1,grid:{display:!1}},y:{display:!1,grid:{display:!1}}},elements:{point:{radius:0},line:{cubicInterpolationMode:"monotone",borderColor:"#7775"}},aspectRatio:25}}),(0,f.jsx)(i.Z,{range:!0,value:v,marks:b,step:null,dots:!0,tooltip:{formatter:e=>(0,f.jsx)(f.Fragment,{children:d()(e).format(u?"DD.MM.YY":"MM.YY")})},min:C[0],max:C[1],defaultValue:s,onChange:y,onChangeComplete:I})]})]}):(0,f.jsx)(f.Fragment,{})})),v=(0,n.memo)(Z)},8781:(e,t,s)=>{s.r(t),s.d(t,{default:()=>me});var n=s(2791),r=s(8418),a=s(6220),l=s(7201),i=s(5160),o=s(1429),c=s(952),d=s(4587),u=s(914),g=s(3936),m=s(7257),h=s(4320),p=s(8807),x=s(2499),j=s(732),S=s(2622),f=s(1752),Z=s(4878);const v=function(e,t){switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:Z.Z.baseCurrency){case"USD":e.EUR=e.USD*t.EUR,e.RUB=e.USD*t.RUB;break;case"EUR":e.USD=e.EUR/t.EUR,e.RUB=e.EUR*t.RUB/t.EUR;break;case"RUB":e.EUR=e.RUB/t.RUB*t.EUR,e.USD=e.RUB/t.RUB}return e};var y=s(8416),C=s(6005),b=s(1468),I=s(7715),R=s(3070),k=s(6106),E=s(3556),O=s(7892),M=s.n(O),z=s(3475),U=s(126),D=s(8228),w=s(184);const P=(0,m.Pi)((e=>{let{id:t,onChange:s}=e;const{categories:n,getCategoryById:r}=z.categoryStore,{isSmallScreen:a}=p.userStore;return(0,w.jsx)(U.Z,{size:a?"small":"middle",allowClear:!0,style:{minInlineSize:"7em"},onChange:s,value:t,suffixIcon:(0,w.jsx)(D.Z,{style:{color:r(t).color}}),children:n.map((e=>(0,w.jsx)(U.Z.Option,{value:e.id,children:e.name},e.id)))})}));var B=s(7575),A=s(7703);const T=(0,m.Pi)((e=>{let{opened:t,initialItem:s,toggleOpened:r,submitItem:a}=e;const[l,i]=(0,n.useState)(Z.Z.baseCurrency),{currencyRates:o,isSmallScreen:c}=p.userStore,{userOptions:d}=A.optionsStore,{language:g}=d,[m,h]=(0,n.useState)(s),x=(0,n.useCallback)((e=>{const{value:t}=e.target;h((e=>({...e,title:t})))}),[h]),S=(0,n.useCallback)((e=>{e&&h((t=>({...t,date:e})))}),[h]),f=(0,n.useCallback)((e=>{h((t=>({...t,categoryId:e})))}),[h]),O=(0,n.useCallback)((e=>{const{value:t}=e.target;h((e=>{const s={...e,price:{...e.price,[l]:Number(t)}};return{...s,price:v(s.price,o,l)}}))}),[h,l,o]);(0,n.useEffect)((()=>{const e=s=>{"Enter"===s.key&&t&&(a(m),window.removeEventListener("keyup",e))};return window.addEventListener("keyup",e),()=>{window.removeEventListener("keyup",e)}}),[m,a,t]);const z=(0,w.jsx)(C.Z,{required:!0,type:"text",value:m.title,onInput:x}),U=(0,w.jsx)(C.Z,{required:!0,type:"number",min:"1",step:"1",value:Math.round(m.price[l]),onInput:O}),D=(0,w.jsx)(E.Z,{value:l,setCurrency:i,onChange:i}),T=(0,w.jsx)(b.Z,{required:!0,onChange:S,value:m.date,minDate:Z.Z.startDate,maxDate:M()()}),F=(0,w.jsx)(P,{id:m.categoryId,onChange:f});return(0,w.jsx)(I.Z,{open:t,okButtonProps:{size:c?"small":"middle"},cancelButtonProps:{size:c?"small":"middle"},onOk:()=>{a(m)},onCancel:()=>{h(s),r()},okText:(0,w.jsx)(B.Z,{}),cancelText:(0,w.jsx)(j.Z,{}),children:(0,w.jsxs)(R.Z,{size:c?"small":"middle",layout:"vertical",style:{inlineSize:"100%"},children:[(0,w.jsx)(R.Z.Item,{label:y.Z.title[g],children:z}),(0,w.jsx)(R.Z.Item,{label:y.Z.price[g],children:(0,w.jsxs)(k.Z,{children:[(0,w.jsx)(u.Z,{span:16,children:U}),(0,w.jsx)(u.Z,{span:1}),(0,w.jsx)(u.Z,{span:7,children:D})]})}),(0,w.jsx)(R.Z.Item,{label:y.Z.dateAndCat[g],children:(0,w.jsxs)(k.Z,{children:[(0,w.jsx)(u.Z,{span:10,children:T}),(0,w.jsx)(u.Z,{span:1}),(0,w.jsx)(u.Z,{span:13,children:F})]})})]})})})),F=(0,m.Pi)((e=>{let{mode:t,initialItem:s}=e;const{id:m,categoryId:Z,date:v,title:C,price:b}=s,{isSmallScreen:I}=p.userStore,{replaceItem:R,removeItem:k}=h.listStore,{userOptions:E}=A.optionsStore,{getCategoryById:O}=z.categoryStore,{currency:M,language:U}=E,[D,P]=(0,n.useState)(!1),[B,F]=(0,n.useState)(0),[Y,L]=(0,n.useState)(!1),[N,_]=(0,n.useState)({id:m,date:v,title:C,categoryId:Z,price:b}),q=()=>{P((e=>!e))};(0,n.useEffect)((()=>{const e=setInterval((()=>{F((t=>{const s=t+10;return s>=E.deleteDelay&&D&&(k(N),clearInterval(e)),s}))}),10);return D||(clearInterval(e),F(0)),()=>clearInterval(e)}),[D,N,k,E.deleteDelay]);const J=(0,n.useCallback)((()=>{L((e=>!e))}),[L]),V=(0,n.useCallback)((e=>{_((t=>JSON.stringify(t)!==JSON.stringify(e)?(R(e),e):t)),J()}),[_,R,J]),$=(0,w.jsx)(l.Z,{justify:"center",style:{opacity:D||!N.title?".5":"1"},children:I?(0,w.jsx)(i.Z.Text,{strong:!0,ellipsis:!0,children:N.title||y.Z.noTitle[U]}):(0,w.jsx)(x.Z,{ellipsis:!0,level:3,style:{margin:0},children:N.title||y.Z.noTitle[U]})}),G=(0,w.jsx)(o.Z,{value:N.date.format("DD.MM.YY"),style:{scale:I?".75":"1",opacity:D?".5":"1"}}),H=(0,n.useMemo)((()=>O(N.categoryId)),[N,O]),K=(0,w.jsx)(l.Z,{vertical:!0,align:"stretch",style:{opacity:D?".5":"1"},children:(0,w.jsx)(c.Z,{color:H.color,children:(0,w.jsx)("span",{style:{margin:"auto",color:H.color,filter:"invert(1)"},children:H.name})})}),Q=(0,w.jsx)(l.Z,{justify:"center",style:{opacity:D?".5":"1"},children:I?(0,w.jsxs)(i.Z.Text,{strong:!0,children:[(0,r.R)(M),Math.round(N.price[M])]}):(0,w.jsx)(x.Z,{level:3,style:{margin:0},children:(0,r.R)(M,N.price[M])})}),W=D?(0,w.jsx)(j.Z,{onClick:q,style:{scale:I?"1":"1.5"}}):(0,w.jsx)(S.Z,{onClick:q,style:{scale:I?"1":"1.5"}}),X=(0,w.jsx)(d.Z,{showInfo:!1,percent:B/E.deleteDelay*100,status:"exception"}),ee=(0,w.jsx)(f.Z,{onClick:D?()=>{}:()=>J(),style:{scale:I?"1":"1.5"}}),te=(0,w.jsxs)(l.Z,{justify:"space-evenly",children:[ee,Q,W]});return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(T,{opened:Y,initialItem:N,toggleOpened:J,submitItem:V}),"list"===t?(0,w.jsx)(a.Z,{children:D?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(u.Z,{span:21,children:X}),(0,w.jsx)(u.Z,{children:W})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(u.Z,{children:G}),(0,w.jsx)(u.Z,{span:9,children:$}),(0,w.jsx)(u.Z,{span:3,children:K}),(0,w.jsx)(u.Z,{span:5,children:Q}),(0,w.jsx)(u.Z,{children:ee}),(0,w.jsx)(u.Z,{children:W})]})}):(0,w.jsx)(g.Z,{size:I?"small":"default",bordered:!0,title:D?X:$,actions:[te],children:(0,w.jsx)(l.Z,{justify:"center",children:(0,w.jsxs)(l.Z,{vertical:!0,align:"stretch",gap:4,children:[G,K]})})})]})}));var Y=s(4664),L=s(6051),N=s(6619);const _=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250;const[s,r]=(0,n.useState)(e);return(0,n.useEffect)((()=>{const s=setTimeout((()=>{r(e)}),t);return()=>{clearTimeout(s)}}),[e,t]),s};var q=s(6281);const J=(0,m.Pi)((e=>{let{filteredList:t}=e;const{loading:s}=h.listStore,{width:r}=p.userStore,{listOptions:a}=A.optionsStore,l=_(a),[i,o]=(0,n.useState)(4);(0,n.useEffect)((()=>{o(r<350?1:r<450?2:r<850?3:4)}),[o,r]);const c=(0,n.useMemo)((()=>(0,N.ls)(l,t)),[t,l]),d=(0,n.useMemo)((()=>{const e=[];let t=-1;return c.forEach(((s,n)=>{n%i===0&&(t++,e.push([])),e[t].push(s)})),e}),[i,c]);return(0,w.jsxs)(w.Fragment,{children:[s?(0,w.jsx)(q.Z,{}):!t.length&&(0,w.jsx)(Y.Z,{image:Y.Z.PRESENTED_IMAGE_SIMPLE,description:""}),"list"===l.mode?(0,w.jsx)(L.Z,{style:{inlineSize:"100%"},children:c.map((e=>(0,w.jsx)(F,{mode:l.mode,initialItem:e},e.id)))}):d.map((e=>(0,w.jsx)(k.Z,{gutter:16,style:{inlineSize:"100%"},children:e.map((e=>(0,w.jsx)(u.Z,{span:24/i,children:(0,w.jsx)(F,{mode:l.mode,initialItem:e})},e.id)))},e[0].id)))]})})),V=(0,n.memo)(J);var $=s(2556),G=s(7128),H=s(6834),K=s(9286);const Q=(0,m.Pi)((()=>{const{addItem:e}=h.listStore,{isSmallScreen:t}=p.userStore,s=(0,n.useMemo)((()=>Z.Z.emptyItem),[]),[r,a]=(0,n.useState)(s),[l,i]=(0,n.useState)(!1),o=(0,n.useCallback)((()=>{i((e=>!e))}),[i]),c=(0,n.useCallback)((()=>{a(s)}),[a,s]),d=(0,n.useCallback)((t=>{e(t),c(),o()}),[e,o,c]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)($.ZP,{onClick:o,size:t?"small":"middle",children:(0,w.jsx)(K.Z,{})}),(0,w.jsx)(T,{opened:l,initialItem:r,toggleOpened:o,submitItem:d})]})}));var W=s(8537);const X=(0,m.Pi)((()=>{const{categories:e}=z.categoryStore,{isSmallScreen:t}=p.userStore,{listOptions:s,handleCategoriesToFilterChange:n}=A.optionsStore;return(0,w.jsx)(U.Z,{size:t?"small":"middle",mode:"multiple",showSearch:!1,tagRender:t=>((e,t)=>{var s;const{label:n,value:r,onClose:a}=e,l=null===(s=t.find((e=>e.id===r)))||void 0===s?void 0:s.color;return(0,w.jsx)(c.Z,{color:l,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},closable:!0,onClose:a,style:{marginInlineEnd:4},children:(0,w.jsx)("span",{style:{color:l,filter:"invert(1)"},children:n})})})(t,e),style:{minInlineSize:"10em"},value:s.categoriesToFilter.map((e=>e.id)),onChange:n,children:e.map((e=>(0,w.jsx)(U.Z.Option,{value:e.id,children:e.name},e.id)))})}));var ee=s(4248),te=s(4544),se=s(54),ne=s(9168),re=s(2785),ae=s(897);const le=(0,m.Pi)((()=>{const{isSmallScreen:e}=p.userStore,{setIsSortingReversed:t,listOptions:s,handleSortAlgorithmChanging:n}=A.optionsStore;return(0,w.jsxs)(l.Z,{gap:8,style:{alignSelf:"start"},children:[s.isSortingReversed?(0,w.jsx)(te.Z,{}):(0,w.jsx)(se.Z,{}),(0,w.jsx)(ee.Z,{size:e?"small":"middle",value:s.sortingAlgorithm,onDoubleClick:()=>t(!s.isSortingReversed),onChange:n,options:[{label:(0,w.jsx)(ne.Z,{}),value:"date"},{label:(0,w.jsx)(re.Z,{}),value:"title"},{label:(0,w.jsx)(ae.Z,{}),value:"price"}]})]})}));var ie=s(6324),oe=s(9197);const ce=(0,m.Pi)((()=>{const{isSmallScreen:e}=p.userStore,{listOptions:t,handleModeChanging:s}=A.optionsStore;return(0,w.jsx)(l.Z,{gap:8,style:{alignSelf:"start"},children:(0,w.jsx)(ee.Z,{size:e?"small":"middle",value:t.mode,onChange:s,options:[{label:(0,w.jsx)(ie.Z,{}),value:"list",disabled:e},{label:(0,w.jsx)(oe.Z,{}),value:"grid"}]})})}));var de=s(3605);const ue=(0,m.Pi)((e=>{let{total:t}=e;const{loading:s}=h.listStore,{isSmallScreen:r}=p.userStore,{listOptions:a,resetSettings:i,handlePageChanging:o,setRange:c,setDefaultRange:d,setIsAccurate:u}=A.optionsStore,{isSortingReversed:g,range:m,defaultRange:x,categoriesToFilter:j,pageSize:S,currentPage:f,sortingAlgorithm:v,isAccurate:y}=a,C=(0,n.useMemo)((()=>g||j.length>0||S!==Z.Z.defaultPageSize||1!==f||m[0]&&m[1]&&(m[0]!==x[0]||m[1])!==x[1]||"date"!==v),[m,x,g,j,S,f,v]);return(0,w.jsxs)(l.Z,{vertical:!0,style:{inlineSize:"100%"},children:[(0,w.jsxs)(l.Z,{vertical:!0,gap:32,children:[(0,w.jsxs)(l.Z,{gap:16,vertical:r,children:[(0,w.jsxs)(l.Z,{gap:16,children:[(0,w.jsx)(Q,{}),(0,w.jsx)(X,{})]}),(0,w.jsxs)(l.Z,{gap:16,children:[(0,w.jsx)(le,{}),(0,w.jsx)(ce,{}),(0,w.jsx)($.ZP,{disabled:!C,onClick:i,size:r?"small":"middle",children:(0,w.jsx)(de.Z,{})})]})]}),(0,w.jsx)(W.Z,{setIsAccurate:u,isAccurate:y,range:m,defaultRange:x,setRange:c,setDefaultRange:d})]}),(0,w.jsx)(G.Z,{}),!s&&(0,w.jsx)(H.Z,{style:{alignSelf:"center"},size:r?"small":"default",showSizeChanger:!0,pageSizeOptions:Z.Z.pageSizeOptions,current:a.currentPage,pageSize:a.pageSize,total:t,onChange:o,onShowSizeChange:o})]})})),ge=(0,m.Pi)((()=>{const{isSmallScreen:e}=p.userStore,{list:t}=h.listStore,{listOptions:s,userOptions:r,handleModeChanging:a,handlePageChanging:i}=A.optionsStore,{language:o}=r,{range:c,sortingAlgorithm:d,isSortingReversed:u,categoriesToFilter:g,pageSize:m,isAccurate:x}=s;(0,n.useEffect)((()=>{e&&a("grid")}),[e,a]),(0,n.useEffect)((()=>{i(1,m)}),[c,d,u,g,m,i]);const j=(0,n.useMemo)((()=>(0,N.ky)(s,t,o,x)),[t,o,s,x]);return(0,w.jsxs)(l.Z,{vertical:!0,gap:16,align:"center",children:[(0,w.jsx)(ue,{total:j.length}),(0,w.jsx)(V,{filteredList:j})]})})),me=ge},6619:(e,t,s)=>{s.d(t,{BF:()=>m,CH:()=>u,ky:()=>o,ls:()=>c,r6:()=>g,u1:()=>d});var n=s(8418),r=s(7892),a=s.n(r),l=s(6818),i=s.n(l);a().extend(i());const o=(e,t,s,r)=>{const{range:l,categoriesToFilter:i,sortingAlgorithm:o,isSortingReversed:c}=e;return(0,n.M)(t.filter((e=>i.length?e.date.isBetween(a()(l[0]),a()(l[1]),"day","[]")&&i.some((t=>e.categoryId===t.id)):e.date.isBetween(a()(l[0]),a()(l[1]),r?"day":"month","[]"))),o,c,s)},c=(e,t)=>{const{currentPage:s,pageSize:n}=e,r=(s-1)*n,a=r+n;return t.slice(r,a)},d=(e,t,s,n)=>{if("year"===s){const s={};e.forEach((e=>{const n=e.date.year();void 0===s[n]?s[n]=0:s[n]+=e.price[t]}));for(let e in s)s[e]=Math.round(s[e]);return s}if("month"===s){const s=new Array(12).fill(0);return e.forEach((e=>{if(e.date.year()===n){const n=e.date.month();s[n]+=e.price[t]}})),s.map((e=>Math.round(e)))}return[]},u=(e,t,s,n,r)=>{const l=[];return e.forEach((e=>{if(e.date.isBetween(a()(t[0]),a()(t[1]),n?"day":"month","[]")){const t=l.findIndex((t=>t.category.id===e.categoryId));-1!==t?l[t].value+=e.price[s]:l.push({category:r(e.categoryId),value:e.price[s]})}})),l.map((e=>({...e,value:Math.round(e.value)})))},g=(e,t,s,n)=>Math.floor(e.reduce(((e,r)=>r.date.isBetween(a()(t[0]),a()(t[1]),n?"hour":"day","()")?e+r.price[s]:e),0)),m=(e,t)=>{const s=[],n=a()(t[1]);let r=a()(t[0]),l=a()(t[0]).add(1,"month");for(;!l.isAfter(n,"day");){const t=e.filter((e=>e.date.isBetween(r,l,"day","[]"))).reduce(((e,t)=>e+t.price.USD),0);s.push(t),r=r.add(1,"month"),l=l.add(1,"month")}return s}},8418:(e,t,s)=>{s.d(t,{M:()=>r,R:()=>n});const n=(e,t)=>{var s;let n="";"USD"===e&&(n+="$"),"EUR"===e&&(n+="\u20ac"),"RUB"===e&&(n+="\u20bd");const r=null===(s=Math.round(t))||void 0===s?void 0:s.toString().split("").reverse().reduce(((e,t,s)=>s%3===0&&0!==s?[...e,t+","]:[...e,t]),[]).reverse().join("");return void 0===t?n:n+r},r=(e,t,s,n)=>{let r;switch(t){case"date":r=[...e].sort(((e,t)=>t.date.valueOf()-e.date.valueOf()));break;case"title":r=[...e].sort(((e,t)=>e.title.localeCompare(t.title,n,{sensitivity:"base"})));break;case"price":r=[...e].sort(((e,t)=>t.price.USD-e.price.USD));break;default:r=[...e]}return s?r.reverse():r}}}]);
//# sourceMappingURL=781.ebde06d0.chunk.js.map