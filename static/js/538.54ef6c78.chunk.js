"use strict";(self.webpackChunkexpenses_manager=self.webpackChunkexpenses_manager||[]).push([[538],{8537:(e,t,a)=>{a.d(t,{Z:()=>v});var s=a(2791),r=a(7257),n=a(7201),o=a(4248),l=a(7708),i=a(4320),c=a(7892),u=a.n(c),d=a(9026),f=a.n(d),m=a(4895),g=a(4187),h=a(6814),p=a(184);u().extend(f());const v=(0,r.Pi)((e=>{let{range:t,defaultRange:a,setRange:r,setDefaultRange:c,isAccurate:d,setIsAccurate:f}=e;const{list:v}=i.listStore,{isSmallScreen:y}=h.userStore,[S,x]=(0,s.useState)(a),O=(0,s.useMemo)((()=>{var e,t;const a=v.map((e=>e.date));return[(null===(e=u().min(a))||void 0===e?void 0:e.valueOf())||0,(null===(t=u().max(a))||void 0===t?void 0:t.valueOf())||0]}),[v]),j=(0,s.useMemo)((()=>{const e=u()(O[0]).startOf("month"),t=u()(O[1]).endOf("month"),a={};let s=e;if(d)for(;s.isBefore(t)||s.isSame(t,"day");)a[s.valueOf()]=1===s.date()?0===s.month()?s.format("YYYY"):s.format("M"):" ",s=s.add(1,"day").startOf("day");else for(;s.isBefore(t)||s.isSame(t,"month");)a[s.valueOf()]=0===s.month()?s.format("YYYY"):" ",s=s.add(1,"month").startOf("month");return a}),[O,d]);(0,s.useEffect)((()=>{c(O)}),[O,c]),(0,s.useEffect)((()=>{r(a)}),[a,r]);const b=(0,s.useCallback)((e=>{r(e)}),[r]);return(0,s.useEffect)((()=>{x(t)}),[t]),(0,s.useEffect)((()=>{y&&f(!1)}),[y,f]),(0,s.useEffect)((()=>{!d&&r([u()(t[0]).startOf("month").valueOf(),u()(t[1]).endOf("month").valueOf()])}),[d]),(0,p.jsxs)(n.Z,{gap:16,children:[(0,p.jsx)(o.Z,{size:y?"small":"middle",defaultValue:d,value:d,onChange:f,options:[{label:(0,p.jsx)(m.Z,{}),value:!1},{label:(0,p.jsx)(g.Z,{}),value:!0,disabled:y}]}),(0,p.jsx)(l.Z,{range:!0,value:S,marks:j,step:null,dots:!0,tooltip:{formatter:e=>(0,p.jsx)(p.Fragment,{children:u()(e).format(d?"DD.MM.YY":"MM.YY")})},min:O[0],max:O[1],defaultValue:a,onChange:x,onChangeComplete:b,style:{inlineSize:"100%"}})]})}))},538:(e,t,a)=>{a.r(t),a.d(t,{default:()=>C});var s=a(2791),r=a(7257),n=a(4320),o=a(5160),l=a(7201),i=a(3936),c=a(1429),u=a(2556),d=a(4664),f=a(6814),m=a(3623),g=a(8416),h=a(8418),p=a(7892),v=a.n(p),y=a(5967),S=a(6619),x=a(7703),O=a(184);y.kL.register(y.u,y.vn,y.ZL,y.uw,y.f$);const j=(0,r.Pi)((e=>{let{mode:t,setMode:a}=e;const{isSmallScreen:r}=f.userStore,{list:o}=n.listStore,{statsOptions:i,userOptions:c,setStatsRange:u}=x.optionsStore,{currency:d,language:p}=c,{range:y}=i,j=(0,s.useMemo)((()=>(0,S.u1)(o,d)),[d,o]),b={labels:"month"===t?g.Z.months[p]:Object.keys(j),datasets:[{label:(0,h.R)(d),data:Object.values(j),backgroundColor:"#f00"}]},M={plugins:{legend:{display:!1}},onClick:(e,s)=>{if(s.length){const e=s[0].index,r="year"===t?[v()(y[0]).year(Number(b.labels[e])).startOf("year").valueOf(),v()(y[0]).year(Number(b.labels[e])).endOf("year").valueOf()]:[v()(y[0]).month(e).startOf("month").valueOf(),v()(y[0]).month(e).endOf("month").valueOf()];"year"===t&&a("month"),u(r)}}};return(0,O.jsx)(l.Z,{style:{inlineSize:r?"unset":"50%"},children:(0,O.jsx)(m.$Q,{data:b,options:M})})}));y.kL.register(y.qi,y.tt,y.u,y.De,y.Dx);const b=(0,r.Pi)((()=>{const{isSmallScreen:e}=f.userStore,{list:t}=n.listStore,{userOptions:a,statsOptions:r}=x.optionsStore,{currency:o}=a,{range:i,isAccurate:c}=r,u=(0,s.useMemo)((()=>(0,S.CH)(t,i,o,c)),[t,o,i,c]),[d,g,p]=[u.map((e=>e.category.name)),u.map((e=>e.category.color)),u.map((e=>Math.round(e.value)))],v={labels:d,datasets:[{label:(0,h.R)(o),data:p,backgroundColor:g}]};return(0,O.jsx)(l.Z,{style:{inlineSize:e?"unset":"40%"},children:(0,O.jsx)(m.by,{data:v,options:{plugins:{legend:{display:!0,position:"right"}}}})})}));var M=a(3605),Z=a(3475),k=a(6818),R=a.n(k),E=a(8537),Y=a(6281);v().extend(R());const w=(0,r.Pi)((()=>{const{list:e}=n.listStore,{isSmallScreen:t}=f.userStore,{statsOptions:a,userOptions:r,setStatsRange:m,setDefaultStatsRange:g,setIsStatsAccurate:p}=x.optionsStore,{currency:y}=r,{range:k,defaultRange:R,isAccurate:w}=a,[C,D]=(0,s.useState)("year"),A=(0,s.useCallback)((()=>{D("year"),m(R)}),[D,R,m]);(0,s.useEffect)((()=>{const e=e=>{"Escape"===e.key&&A()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[A]);const z=(0,s.useMemo)((()=>k[0]!==R[0]||k[1]!==R[1]),[k,R]),P=(0,s.useMemo)((()=>{const e=w?"DD.MM.YY":"MM.YY";return(0,O.jsxs)(o.Z.Text,{type:"secondary",style:{fontSize:t?".8em":"1em"},children:[v()(k[0]).format(e),k[0]!==k[1]?"-".concat(v()(k[1]).format(e)):""]})}),[w,k,t]),B=(0,O.jsxs)(l.Z,{gap:16,children:[(0,O.jsx)(i.Z,{bordered:!0,children:(0,O.jsx)(c.Z,{title:P,value:(0,S.r6)(e,k,y,w),prefix:(0,h.R)(y),valueStyle:{color:"#f00",fontSize:t?"1em":"1.5em"}})}),(0,O.jsx)(u.ZP,{size:t?"small":"middle",onClick:A,disabled:!z,children:(0,O.jsx)(M.Z,{})})]}),I=(0,O.jsxs)(l.Z,{vertical:!0,gap:16,align:"stretch",children:[(0,O.jsx)(E.Z,{setIsAccurate:p,isAccurate:w,range:k,defaultRange:R,setRange:m,setDefaultRange:g}),(0,O.jsxs)(l.Z,{align:"center",justify:"space-between",vertical:t,children:[(0,O.jsx)(j,{mode:C,setMode:D}),(0,O.jsx)(b,{})]})]});return n.listStore.loading||Z.categoryStore.loading?(0,O.jsx)(Y.Z,{}):e.length?(0,O.jsxs)(l.Z,{vertical:!0,gap:32,children:[B,I]}):(0,O.jsx)(d.Z,{image:d.Z.PRESENTED_IMAGE_SIMPLE,description:""})})),C=(0,s.memo)(w)},6619:(e,t,a)=>{a.d(t,{CH:()=>d,ky:()=>i,ls:()=>c,r6:()=>f,u1:()=>u});var s=a(8418),r=a(7892),n=a.n(r),o=a(6818),l=a.n(o);n().extend(l());const i=(e,t,a,r)=>{const{range:o,categoriesToFilter:l,sortingAlgorithm:i,isSortingReversed:c}=e;return(0,s.M)(t.filter((e=>l.length?e.date.isBetween(n()(o[0]),n()(o[1]),"day","[]")&&l.some((t=>e.category.id===t.id)):e.date.isBetween(n()(o[0]),n()(o[1]),r?"day":"month","[]"))),i,c,a)},c=(e,t)=>{const{currentPage:a,pageSize:s}=e,r=(a-1)*s,n=r+s;return t.slice(r,n)},u=(e,t)=>{const a={};e.forEach((e=>{const s=e.date.year();void 0===a[s]?a[s]=0:a[s]+=e.price[t]}));for(let s in a)a[s]=Math.round(a[s]);return a},d=(e,t,a,s)=>{const r=[];return e.forEach((e=>{if(e.date.isBetween(n()(t[0]),n()(t[1]),s?"day":"month","[]")){const t=r.findIndex((t=>t.category.id===e.category.id));-1!==t?r[t].value+=e.price[a]:r.push({category:e.category,value:e.price[a]})}})),r.map((e=>({...e,value:Math.round(e.value)})))},f=(e,t,a,s)=>Math.floor(e.reduce(((e,r)=>r.date.isBetween(n()(t[0]),n()(t[1]),s?"day":"month","[]")?e+r.price[a]:e),0))},8418:(e,t,a)=>{a.d(t,{M:()=>r,R:()=>s});const s=(e,t)=>{var a;let s="";"USD"===e&&(s+="$"),"EUR"===e&&(s+="\u20ac"),"RUB"===e&&(s+="\u20bd");const r=null===(a=Math.round(t))||void 0===a?void 0:a.toString().split("").reverse().reduce(((e,t,a)=>a%3===0&&0!==a?[...e,t+","]:[...e,t]),[]).reverse().join("");return void 0===t?s:s+r},r=(e,t,a,s)=>{let r;switch(t){case"date":r=[...e].sort(((e,t)=>t.date.valueOf()-e.date.valueOf()));break;case"title":r=[...e].sort(((e,t)=>e.title.localeCompare(t.title,s,{sensitivity:"base"})));break;case"price":r=[...e].sort(((e,t)=>t.price.USD-e.price.USD));break;default:r=[...e]}return a?r.reverse():r}}}]);
//# sourceMappingURL=538.54ef6c78.chunk.js.map