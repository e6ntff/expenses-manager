"use strict";(self.webpackChunkexpenses_manager=self.webpackChunkexpenses_manager||[]).push([[781],{2158:(e,t,s)=>{s.d(t,{Z:()=>I});var n=s(2791),r=s(7257),a=s(7201),l=s(4248),i=s(7708),o=s(4320),c=s(7892),d=s.n(c),u=s(9026),m=s.n(u),g=s(4895),p=s(4187),h=s(6814),x=s(5967),j=s(3623),f=s(7703),S=s(6619),Z=s(184);const v=(0,r.Pi)((()=>{const{list:e}=o.listStore,{defaultRange:t}=f.optionsStore,s=(0,n.useMemo)((()=>(0,S.BF)(e,t)),[e,t]),r={labels:new Array(s.length).fill(""),datasets:[{data:s}]};return(0,Z.jsx)(j.x1,{style:{inlineSize:"100%"},data:r,options:{plugins:{legend:{display:!1},tooltip:{enabled:!1}},scales:{x:{display:!1,grid:{display:!1}},y:{display:!1,grid:{display:!1}}},elements:{point:{radius:0},line:{cubicInterpolationMode:"monotone",borderColor:"#7775"}},aspectRatio:25}})})),y=(0,n.memo)(v);x.kL.register(x.u,x.jn,x.ST,x.uw,x.f$,x.od),d().extend(m());const b=(0,r.Pi)((e=>{let{range:t,setRange:s,isAccurate:r,setIsAccurate:c}=e;const{list:u}=o.listStore,{isSmallScreen:m}=h.userStore,{defaultRange:x,setDefaultRange:j}=f.optionsStore,[S,v]=(0,n.useState)(x),b=(0,n.useMemo)((()=>{var e,t;const s=Object.values(u).map((e=>d()(e.date)));return[(null===(e=d().min(s))||void 0===e?void 0:e.valueOf())||0,(null===(t=d().max(s))||void 0===t?void 0:t.valueOf())||0]}),[u]),I=(0,n.useMemo)((()=>{const e=d()(b[0]).startOf("day"),t=d()(b[1]).endOf("day"),s={};let n=e;if(r)for(;n.isBefore(t)||n.isSame(t,"day");)s[n.valueOf()]=1===n.date()?0===n.month()?n.format("YYYY"):n.format("M"):" ",n=n.add(1,"day").startOf("day");else for(;n.isBefore(t)||n.isSame(t,"month");)s[n.valueOf()]=0===n.month()?n.format("YYYY"):" ",n=n.add(1,"month").startOf("month");return s}),[b,r]);(0,n.useEffect)((()=>{j(b)}),[b,j]),(0,n.useEffect)((()=>{s(x)}),[x,s]);const C=(0,n.useCallback)((e=>{s(e)}),[s]);return(0,n.useEffect)((()=>{v(t)}),[t]),(0,n.useEffect)((()=>{m&&c(!1)}),[m,c]),(0,n.useEffect)((()=>{!r&&s([d().max([d()(t[0]).startOf("month"),d()(x[0])]).valueOf(),d().min([d()(t[1]).endOf("month"),d()(x[1])]).valueOf()])}),[r]),d()(x[1]).diff(d()(x[0]),"hours")>=48?(0,Z.jsxs)(a.Z,{gap:16,align:"center",children:[(0,Z.jsx)(l.Z,{size:m?"small":"middle",defaultValue:r,value:r,onChange:c,options:[{label:(0,Z.jsx)(g.Z,{}),value:!1},{label:(0,Z.jsx)(p.Z,{}),value:!0,disabled:m}]}),(0,Z.jsxs)(a.Z,{vertical:!0,align:"stretch",style:{inlineSize:"100%"},children:[(0,Z.jsx)(y,{}),(0,Z.jsx)(i.Z,{range:!0,value:S,marks:I,step:null,dots:!0,tooltip:{formatter:e=>(0,Z.jsx)(Z.Fragment,{children:d()(e).format(r?"DD.MM.YY":"MM.YY")})},min:b[0],max:b[1],defaultValue:x,onChange:v,onChangeComplete:C})]})]}):(0,Z.jsx)(Z.Fragment,{})})),I=(0,n.memo)(b)},8781:(e,t,s)=>{s.r(t),s.d(t,{default:()=>fe});var n=s(2791),r=s(8418),a=s(6220),l=s(7201),i=s(5160),o=s(1429),c=s(952),d=s(4587),u=s(4231),m=s(914),g=s(3936),p=s(7257),h=s(4320),x=s(6814),j=s(2499),f=s(732),S=s(2622),Z=s(1752),v=s(9966),y=s(4878);const b=function(e,t){switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.Z.baseCurrency){case"USD":e.EUR=e.USD*t.EUR,e.RUB=e.USD*t.RUB;break;case"EUR":e.USD=e.EUR/t.EUR,e.RUB=e.EUR*t.RUB/t.EUR;break;case"RUB":e.EUR=e.RUB/t.RUB*t.EUR,e.USD=e.RUB/t.RUB}return e};var I=s(8416),C=s(6005),O=s(1468),k=s(7715),R=s(3070),M=s(6106),E=s(3556),z=s(7892),D=s.n(z),U=s(3475),A=s(126),P=s(8228),w=s(184);const Y=(0,p.Pi)((e=>{let{id:t,onChange:s}=e;const{categories:n}=U.categoryStore,{isSmallScreen:r}=x.userStore;return(0,w.jsx)(A.Z,{size:r?"small":"middle",allowClear:!0,style:{minInlineSize:"7em"},onChange:s,value:t,suffixIcon:(0,w.jsx)(P.Z,{style:{color:n[t].color}}),children:Object.keys(n).map((e=>(0,w.jsx)(A.Z.Option,{value:e,children:n[e].name},e)))})}));var B=s(7575),F=s(7703);const T=(0,p.Pi)((e=>{let{opened:t,initialItemId:s,toggleOpened:r,submitItem:a}=e;const[l,i]=(0,n.useState)(y.Z.baseCurrency),{currencyRates:o,isSmallScreen:c}=x.userStore,{userOptions:d}=F.optionsStore,{list:u}=h.listStore,{language:g}=d,p=(0,n.useMemo)((()=>void 0!==s?u[s]:y.Z.emptyItem),[u,s]),[j,S]=(0,n.useState)(p),Z=(0,n.useCallback)((e=>{const{value:t}=e.target;S((e=>({...e,title:t})))}),[S]),v=(0,n.useCallback)((e=>{e&&S((t=>({...t,date:e.valueOf()})))}),[S]),z=(0,n.useCallback)((e=>{S((t=>({...t,categoryId:e})))}),[S]),U=(0,n.useCallback)((e=>{const{value:t}=e.target;S((e=>{const s={...e,price:{...e.price,[l]:Number(t)}};return{...s,price:b(s.price,o,l)}}))}),[S,l,o]);(0,n.useEffect)((()=>{const e=s=>{"Enter"===s.key&&t&&(a(j),window.removeEventListener("keyup",e))};return window.addEventListener("keyup",e),()=>{window.removeEventListener("keyup",e)}}),[j,a,t]);const A=(0,w.jsx)(C.Z,{required:!0,type:"text",value:j.title,onInput:Z}),P=(0,w.jsx)(C.Z,{required:!0,type:"number",min:"1",step:"1",value:Math.round(j.price[l]),onInput:U}),T=(0,w.jsx)(E.Z,{value:l,setCurrency:i,onChange:i}),L=(0,w.jsx)(O.Z,{required:!0,onChange:v,value:D()(j.date),minDate:y.Z.startDate,maxDate:D()()}),H=(0,w.jsx)(Y,{id:j.categoryId,onChange:z});return(0,w.jsx)(k.Z,{open:t,okButtonProps:{size:c?"small":"middle"},cancelButtonProps:{size:c?"small":"middle"},onOk:()=>{a(j)},onCancel:()=>{S(p),r()},okText:(0,w.jsx)(B.Z,{}),cancelText:(0,w.jsx)(f.Z,{}),children:(0,w.jsxs)(R.Z,{size:c?"small":"middle",layout:"vertical",style:{inlineSize:"100%"},children:[(0,w.jsx)(R.Z.Item,{label:I.Z.title[g],children:A}),(0,w.jsx)(R.Z.Item,{label:I.Z.price[g],children:(0,w.jsxs)(M.Z,{children:[(0,w.jsx)(m.Z,{span:16,children:P}),(0,w.jsx)(m.Z,{span:1}),(0,w.jsx)(m.Z,{span:7,children:T})]})}),(0,w.jsx)(R.Z.Item,{label:I.Z.dateAndCat[g],children:(0,w.jsxs)(M.Z,{children:[(0,w.jsx)(m.Z,{span:10,children:L}),(0,w.jsx)(m.Z,{span:1}),(0,w.jsx)(m.Z,{span:13,children:H})]})})]})})})),L=T,H=(0,p.Pi)((e=>{let{mode:t,initialItemId:s}=e;const{isSmallScreen:p}=x.userStore,{replaceItem:y,removeItem:b,list:C}=h.listStore,{userOptions:O}=F.optionsStore,{categories:k}=U.categoryStore,{currency:R,language:M}=O,[E,z]=(0,n.useState)(!1),[A,P]=(0,n.useState)(0),[Y,B]=(0,n.useState)(!1),[T,H]=(0,n.useState)(C[s]),N=()=>{z((e=>!e))};(0,n.useEffect)((()=>{const e=setInterval((()=>{P((t=>{const n=t+10;return n>=O.deleteDelay&&E&&(b(s),clearInterval(e)),n}))}),10);return E||(clearInterval(e),P(0)),()=>clearInterval(e)}),[E,T,b,O.deleteDelay,s]);const _=(0,n.useCallback)((()=>{B((e=>!e))}),[B]),q=(0,n.useCallback)((e=>{H((t=>{if(JSON.stringify(t)!==JSON.stringify(e)){const t={...e,updatedAt:D()().valueOf()};return y(s,t),t}return t})),_()}),[H,y,_,s]),J=(0,w.jsx)(l.Z,{justify:"center",style:{opacity:E||!T.title?".5":"1"},children:p?(0,w.jsx)(i.Z.Text,{strong:!0,ellipsis:!0,children:T.title||I.Z.noTitle[M]}):(0,w.jsx)(j.Z,{ellipsis:!0,level:3,style:{margin:0},children:T.title||I.Z.noTitle[M]})}),V=(0,w.jsx)(o.Z,{value:D()(T.date).format("DD.MM.YY"),style:{scale:p?".75":"1",opacity:E?".5":"1"}}),W=(0,w.jsx)(l.Z,{vertical:!0,align:"stretch",style:{opacity:E?".5":"1"},children:(0,w.jsx)(c.Z,{color:k[T.categoryId].color,children:(0,w.jsx)("span",{style:{margin:"auto",color:k[T.categoryId].color,filter:"invert(1)"},children:k[T.categoryId].name})})}),$=(0,w.jsx)(l.Z,{justify:"center",style:{opacity:E?".5":"1"},children:p?(0,w.jsxs)(i.Z.Text,{strong:!0,children:[(0,r.R)(R),Math.round(T.price[R])]}):(0,w.jsx)(j.Z,{level:3,style:{margin:0},children:(0,r.R)(R,T.price[R])})}),G=E?(0,w.jsx)(f.Z,{onClick:N,style:{scale:p?"1":"1.5"}}):(0,w.jsx)(S.Z,{onClick:N,style:{scale:p?"1":"1.5"}}),K=(0,w.jsx)(d.Z,{showInfo:!1,percent:A/O.deleteDelay*100,status:"exception"}),Q=(0,w.jsx)(Z.Z,{onClick:E?()=>{}:()=>_(),style:{scale:p?"1":"1.5"}}),X=(0,w.jsxs)(l.Z,{justify:"space-evenly",children:[Q,$,G]}),ee=(0,n.useMemo)((()=>T.createdAt===T.updatedAt?(0,w.jsx)(w.Fragment,{children:"".concat(I.Z.createdAt[M]," ").concat(D()(T.createdAt).format("HH:mm:ss DD.MM.YY"))}):(0,w.jsxs)(w.Fragment,{children:["".concat(I.Z.createdAt[M]," ").concat(D()(T.createdAt).format("HH:mm:ss DD.MM.YY")),(0,w.jsx)("br",{}),"".concat(I.Z.updatedAt[M]," ").concat(D()(T.updatedAt).format("HH:mm:ss DD.MM.YY"))]})),[T,M]),te=(0,w.jsx)(u.Z,{title:ee,children:(0,w.jsx)(v.Z,{})});return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(L,{opened:Y,initialItemId:s,toggleOpened:_,submitItem:q}),"list"===t?(0,w.jsxs)(a.Z,{children:[E?(0,w.jsx)(m.Z,{span:21,children:K}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(m.Z,{children:V}),(0,w.jsx)(m.Z,{span:9,children:J}),(0,w.jsx)(m.Z,{span:3,children:W}),(0,w.jsx)(m.Z,{span:5,children:$}),(0,w.jsx)(m.Z,{children:Q})]}),(0,w.jsx)(m.Z,{children:G}),(0,w.jsx)(m.Z,{children:te})]}):(0,w.jsx)(g.Z,{extra:[te],size:p?"small":"default",bordered:!0,title:E?K:J,actions:[X],children:(0,w.jsx)(l.Z,{justify:"center",children:(0,w.jsxs)(l.Z,{vertical:!0,align:"stretch",gap:4,children:[V,W]})})})]})})),N=H;var _=s(4664),q=s(6051),J=s(6619);const V=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250;const[s,r]=(0,n.useState)(e);return(0,n.useEffect)((()=>{const s=setTimeout((()=>{r(e)}),t);return()=>{clearTimeout(s)}}),[e,t]),s};var W=s(6281);const $=(0,p.Pi)((e=>{let{filteredListIds:t}=e;const{width:s,loading:r}=x.userStore,{listOptions:a}=F.optionsStore,l=V(a),[i,o]=(0,n.useState)(4);(0,n.useEffect)((()=>{o(s<350?1:s<450?2:s<850?3:4)}),[o,s]);const c=(0,n.useMemo)((()=>(0,J.W2)(l,t)),[t,l]),d=(0,n.useMemo)((()=>{const e=[];let t=-1;return c.forEach(((s,n)=>{n%i===0&&(t++,e.push([])),e[t].push(s)})),e}),[i,c]);return(0,w.jsxs)(w.Fragment,{children:[r?(0,w.jsx)(W.Z,{}):!t.length&&(0,w.jsx)(_.Z,{image:_.Z.PRESENTED_IMAGE_SIMPLE,description:""}),"list"===l.mode?(0,w.jsx)(q.Z,{style:{inlineSize:"100%"},children:c.map((e=>(0,w.jsx)(N,{mode:l.mode,initialItemId:e},e)))}):d.map((e=>(0,w.jsx)(M.Z,{gutter:16,style:{inlineSize:"100%"},children:e.map((e=>(0,w.jsx)(m.Z,{span:24/i,children:(0,w.jsx)(N,{mode:l.mode,initialItemId:e})},e)))},e[0])))]})})),G=(0,n.memo)($);var K=s(2556),Q=s(7128),X=s(6834),ee=s(9286);const te=(0,p.Pi)((()=>{const{addItem:e}=h.listStore,{isSmallScreen:t}=x.userStore,[s,r]=(0,n.useState)(!1),a=(0,n.useCallback)((()=>{r((e=>!e))}),[r]),l=(0,n.useCallback)((t=>{const s=D()().valueOf();e({...t,createdAt:s}),a()}),[e,a]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(K.ZP,{onClick:a,size:t?"small":"middle",children:(0,w.jsx)(ee.Z,{})}),(0,w.jsx)(L,{opened:s,toggleOpened:a,submitItem:l})]})}));var se=s(2158);const ne=(0,p.Pi)((()=>{const{categories:e}=U.categoryStore,{isSmallScreen:t}=x.userStore,{listOptions:s,handleCategoriesToFilterChange:n}=F.optionsStore;return(0,w.jsx)(A.Z,{size:t?"small":"middle",mode:"multiple",showSearch:!1,tagRender:t=>((e,t)=>{const{label:s,value:n,onClose:r}=e,a=Object.keys(t).length>1?t[n].color:"";return(0,w.jsx)(c.Z,{color:a,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},closable:!0,onClose:r,style:{marginInlineEnd:4},children:(0,w.jsx)("span",{style:{color:a,filter:"invert(1)"},children:s})})})(t,e),style:{minInlineSize:"10em"},value:s.categoriesToFilterIds,onChange:n,children:Object.keys(e).map((t=>(0,w.jsx)(A.Z.Option,{value:t,children:e[t].name},t)))})}));var re=s(4248),ae=s(4544),le=s(54),ie=s(9168),oe=s(2785),ce=s(897);const de=(0,p.Pi)((()=>{const{isSmallScreen:e}=x.userStore,{setIsSortingReversed:t,listOptions:s,handleSortAlgorithmChanging:n}=F.optionsStore;return(0,w.jsxs)(l.Z,{gap:8,style:{alignSelf:"start"},children:[s.isSortingReversed?(0,w.jsx)(ae.Z,{}):(0,w.jsx)(le.Z,{}),(0,w.jsx)(re.Z,{size:e?"small":"middle",value:s.sortingAlgorithm,onDoubleClick:()=>t(!s.isSortingReversed),onChange:n,options:[{label:(0,w.jsx)(ie.Z,{}),value:"date"},{label:(0,w.jsx)(oe.Z,{}),value:"title"},{label:(0,w.jsx)(ce.Z,{}),value:"price"}]})]})}));var ue=s(6324),me=s(9197);const ge=(0,p.Pi)((()=>{const{isSmallScreen:e}=x.userStore,{listOptions:t,handleModeChanging:s}=F.optionsStore;return(0,w.jsx)(l.Z,{gap:8,style:{alignSelf:"start"},children:(0,w.jsx)(re.Z,{size:e?"small":"middle",value:t.mode,onChange:s,options:[{label:(0,w.jsx)(ue.Z,{}),value:"list",disabled:e},{label:(0,w.jsx)(me.Z,{}),value:"grid"}]})})}));var pe=s(3605);const he=(0,p.Pi)((e=>{let{total:t}=e;const{isSmallScreen:s,loading:r}=x.userStore,{listOptions:a,defaultRange:i,resetListOptions:o,handlePageChanging:c,setRange:d,setIsAccurate:u}=F.optionsStore,{isSortingReversed:m,range:g,categoriesToFilterIds:p,pageSize:h,currentPage:j,sortingAlgorithm:f,isAccurate:S}=a,Z=(0,n.useMemo)((()=>m||p.length>0||h!==y.Z.defaultPageSize||1!==j||g[0]&&g[1]&&(g[0]!==i[0]||g[1])!==i[1]||"date"!==f),[g,i,m,p,h,j,f]);return(0,w.jsxs)(l.Z,{vertical:!0,style:{inlineSize:"100%"},children:[(0,w.jsxs)(l.Z,{vertical:!0,gap:32,children:[(0,w.jsxs)(l.Z,{gap:16,vertical:s,children:[(0,w.jsxs)(l.Z,{gap:16,children:[(0,w.jsx)(te,{}),(0,w.jsx)(ne,{})]}),(0,w.jsxs)(l.Z,{gap:16,children:[(0,w.jsx)(de,{}),(0,w.jsx)(ge,{}),(0,w.jsx)(K.ZP,{disabled:!Z,onClick:o,size:s?"small":"middle",children:(0,w.jsx)(pe.Z,{})})]})]}),(0,w.jsx)(se.Z,{setIsAccurate:u,isAccurate:S,range:g,setRange:d})]}),(0,w.jsx)(Q.Z,{}),!r&&(0,w.jsx)(X.Z,{style:{alignSelf:"center"},size:s?"small":"default",showSizeChanger:!0,pageSizeOptions:y.Z.pageSizeOptions,current:a.currentPage,pageSize:a.pageSize,total:t,onChange:c,onShowSizeChange:c})]})})),xe=(0,n.memo)(he),je=(0,p.Pi)((()=>{const{isSmallScreen:e}=x.userStore,{list:t}=h.listStore,{listOptions:s,userOptions:r,handleModeChanging:a,handlePageChanging:i}=F.optionsStore,{language:o}=r,{range:c,sortingAlgorithm:d,isSortingReversed:u,categoriesToFilterIds:m,pageSize:g}=s;(0,n.useEffect)((()=>{e&&a("grid")}),[e,a]),(0,n.useEffect)((()=>{i(1,g)}),[c,d,u,m,g,i]);const p=(0,n.useMemo)((()=>(0,J.tL)(s,t,o)),[t,o,s]);return(0,w.jsxs)(l.Z,{vertical:!0,gap:16,align:"center",children:[(0,w.jsx)(xe,{total:p.length}),(0,w.jsx)(G,{filteredListIds:p})]})})),fe=je},6619:(e,t,s)=>{s.d(t,{BF:()=>g,CH:()=>u,W2:()=>c,r6:()=>m,tL:()=>o,u1:()=>d});var n=s(8418),r=s(7892),a=s.n(r),l=s(6818),i=s.n(l);a().extend(i());const o=(e,t,s)=>{const{range:r,categoriesToFilterIds:a,sortingAlgorithm:l,isSortingReversed:i}=e;return(0,n.M)(t,Object.keys(t).filter((e=>t[e].date>=r[0]&&t[e].date<=r[1]&&(!a.length||a.some((s=>t[e].categoryId===s))))),l,i,s)},c=(e,t)=>{const{currentPage:s,pageSize:n}=e,r=(s-1)*n,a=r+n;return t.slice(r,a)},d=(e,t,s,n)=>{if("year"===s){const s={};Object.keys(e).forEach((n=>{const r=a()(e[n].date).year();void 0===s[r]?s[r]=e[n].price[t]:s[r]+=e[n].price[t]}));for(let e in s)s[e]=Math.round(s[e]);return s}if("month"===s){const s=new Array(12).fill(0);return Object.keys(e).forEach((r=>{if(a()(e[r].date).year()===n){const n=a()(e[r].date).month();s[n]+=e[r].price[t]}})),s.map((e=>Math.round(e)))}return[]},u=(e,t,s)=>{const n=[];return Object.keys(e).forEach((r=>{if(e[r].date>t[0]&&e[r].date<t[1]){const t=Object.keys(n).findIndex((t=>n[Number(t)].categoryId===e[r].categoryId));-1!==t?n[t].value+=e[r].price[s]:n.push({categoryId:e[r].categoryId,value:e[r].price[s]})}})),n.map((e=>({...e,value:Math.round(e.value)})))},m=(e,t,s)=>Math.floor(Object.values(e).reduce(((e,n)=>n.date>t[0]&&n.date<t[1]?e+n.price[s]:e),0)),g=(e,t)=>{const s=[],n=a()(t[1]);let r=a()(t[0]),l=a()(t[0]).add(1,"month");for(;!l.isAfter(n,"day");){const t=Object.values(e).filter((e=>e.date>r.valueOf()&&e.date<l.valueOf())).reduce(((e,t)=>e+t.price.USD),0);s.push(t),r=r.add(1,"month"),l=l.add(1,"month")}return s}},8418:(e,t,s)=>{s.d(t,{M:()=>r,R:()=>n});const n=(e,t)=>{var s;let n="";"USD"===e&&(n+="$"),"EUR"===e&&(n+="\u20ac"),"RUB"===e&&(n+="\u20bd");const r=null===(s=Math.round(t))||void 0===s?void 0:s.toString().split("").reverse().reduce(((e,t,s)=>s%3===0&&0!==s?[...e,t+","]:[...e,t]),[]).reverse().join("");return void 0===t?n:n+r},r=(e,t,s,n,r)=>{let a;switch(s){case"date":a=t.sort(((t,s)=>e[s].date.valueOf()-e[t].date.valueOf()));break;case"title":a=t.sort(((t,s)=>e[t].title.localeCompare(e[s].title,r,{sensitivity:"base"})));break;case"price":a=t.sort(((t,s)=>e[s].price.USD-e[t].price.USD));break;default:a=t}return n?a.reverse():a}}}]);
//# sourceMappingURL=781.d45d982c.chunk.js.map