"use strict";(self.webpackChunkexpenses_manager=self.webpackChunkexpenses_manager||[]).push([[538],{8537:(e,t,a)=>{a.d(t,{Z:()=>p});var s=a(2791),r=a(7257),n=a(7201),o=a(4248),l=a(7708),i=a(4320),c=a(7892),u=a.n(c),d=a(9026),f=a.n(d),m=a(4895),g=a(4187),h=a(6814),v=a(184);u().extend(f());const p=(0,r.Pi)((e=>{let{range:t,defaultRange:a,setRange:r,setDefaultRange:c,isAccurate:d,setIsAccurate:f}=e;const{list:p}=i.listStore,{isSmallScreen:y}=h.userStore,[S,x]=(0,s.useState)(a),O=(0,s.useMemo)((()=>{var e,t;const a=p.map((e=>e.date));return[(null===(e=u().min(a))||void 0===e?void 0:e.valueOf())||0,(null===(t=u().max(a))||void 0===t?void 0:t.valueOf())||0]}),[p]),b=(0,s.useMemo)((()=>{const e=u()(O[0]).startOf("month"),t=u()(O[1]).endOf("month"),a={};let s=e;if(d)for(;s.isBefore(t)||s.isSame(t,"day");)a[s.valueOf()]=1===s.date()?0===s.month()?s.format("YYYY"):s.format("M"):" ",s=s.add(1,"day").startOf("day");else for(;s.isBefore(t)||s.isSame(t,"month");)a[s.valueOf()]=0===s.month()?s.format("YYYY"):" ",s=s.add(1,"month").startOf("month");return a}),[O,d]);(0,s.useEffect)((()=>{c(O),r(O)}),[O,c,r]);const j=(0,s.useCallback)((e=>{r(e)}),[r]);return(0,s.useEffect)((()=>{x(t)}),[t]),(0,s.useEffect)((()=>{y&&f(!1)}),[y,f]),(0,s.useEffect)((()=>{!d&&r([u()(t[0]).startOf("month").valueOf(),u()(t[1]).endOf("month").valueOf()])}),[d]),(0,v.jsxs)(n.Z,{gap:16,children:[(0,v.jsx)(o.Z,{defaultValue:d,value:d,onChange:f,options:[{label:(0,v.jsx)(m.Z,{}),value:!1},{label:(0,v.jsx)(g.Z,{}),value:!0,disabled:y}]}),(0,v.jsx)(l.Z,{range:!0,value:S,marks:b,step:null,dots:!0,tooltip:{formatter:e=>(0,v.jsx)(v.Fragment,{children:u()(e).format(d?"DD.MM.YY":"MM.YY")})},min:O[0],max:O[1],defaultValue:a,onChange:x,onChangeComplete:j,style:{inlineSize:"100%"}})]})}))},538:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var s=a(2791),r=a(7257),n=a(4320),o=a(7201),l=a(3936),i=a(1429),c=a(2556),u=a(4664),d=a(6814),f=a(3623),m=a(8416),g=a(8418),h=a(7892),v=a.n(h),p=a(5967),y=a(6619),S=a(7703),x=a(184);p.kL.register(p.u,p.vn,p.ZL,p.uw,p.f$);const O=(0,r.Pi)((e=>{let{mode:t,setMode:a}=e;const{isSmallScreen:r}=d.userStore,{list:l}=n.listStore,{statsOptions:i,userOptions:c,setStatsRange:u}=S.optionsStore,{currency:h,language:p}=c,{range:O}=i,b=(0,s.useMemo)((()=>(0,y.u1)(l,h)),[h,l]),j={labels:"month"===t?m.Z.months[p]:Object.keys(b),datasets:[{label:(0,g.R)(h),data:Object.values(b),backgroundColor:"#f00"}]},M={plugins:{legend:{display:!1}},onClick:(e,s)=>{if(s.length){const e=s[0].index,r="year"===t?[v()(O[0]).year(Number(j.labels[e])).startOf("year").valueOf(),v()(O[0]).year(Number(j.labels[e])).endOf("year").valueOf()]:[v()(O[0]).month(e).startOf("month").valueOf(),v()(O[0]).month(e).endOf("month").valueOf()];"year"===t&&a("month"),u(r)}}};return(0,x.jsx)(o.Z,{style:{inlineSize:r?"unset":"50%"},children:(0,x.jsx)(f.$Q,{data:j,options:M})})}));p.kL.register(p.qi,p.tt,p.u,p.De,p.Dx);const b=(0,r.Pi)((()=>{const{isSmallScreen:e}=d.userStore,{list:t}=n.listStore,{userOptions:a,statsOptions:r}=S.optionsStore,{currency:l}=a,{range:i,isAccurate:c}=r,u=(0,s.useMemo)((()=>(0,y.CH)(t,i,l,c)),[t,l,i,c]),[m,h,v]=[u.map((e=>e.category.name)),u.map((e=>e.category.color)),u.map((e=>Math.round(e.value)))],p={labels:m,datasets:[{label:(0,g.R)(l),data:v,backgroundColor:h}]};return(0,x.jsx)(o.Z,{style:{inlineSize:e?"unset":"40%"},children:(0,x.jsx)(f.by,{data:p,options:{plugins:{legend:{display:!0,position:"right"}}}})})}));var j=a(3605),M=a(3475),Z=a(6818),k=a.n(Z),R=a(8537),E=a(6281);v().extend(k());const Y=(0,r.Pi)((()=>{const{list:e}=n.listStore,{isSmallScreen:t}=d.userStore,{statsOptions:a,userOptions:r,setStatsRange:f,setDefaultStatsRange:m,setIsStatsAccurate:h}=S.optionsStore,{currency:p}=r,{range:Z,defaultRange:k,isAccurate:Y}=a,[w,C]=(0,s.useState)("year"),D=(0,s.useCallback)((()=>{C("year"),f(k)}),[C,k,f]);(0,s.useEffect)((()=>{const e=e=>{"Escape"===e.key&&D()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[D]);const A=(0,s.useMemo)((()=>Z[0]!==k[0]||Z[1]!==k[1]),[Z,k]),P=(0,s.useMemo)((()=>{const e=Y?"DD.MM.YY":"MM.YY";return"".concat(v()(Z[0]).format(e)).concat(Z[0]!==Z[1]?"-".concat(v()(Z[1]).format(e)):"")}),[Y,Z]),B=(0,x.jsxs)(o.Z,{gap:16,children:[(0,x.jsx)(l.Z,{bordered:!0,children:(0,x.jsx)(i.Z,{title:P,value:(0,y.r6)(e,Z,p,Y),prefix:(0,g.R)(p),valueStyle:{color:"#f00"}})}),(0,x.jsx)(c.ZP,{size:t?"small":"middle",onClick:D,disabled:!A,children:(0,x.jsx)(j.Z,{})})]}),I=(0,x.jsxs)(o.Z,{vertical:!0,align:"stretch",children:[(0,x.jsx)(R.Z,{setIsAccurate:h,isAccurate:Y,range:Z,defaultRange:k,setRange:f,setDefaultRange:m}),(0,x.jsxs)(o.Z,{align:"center",justify:"space-between",vertical:t,children:[(0,x.jsx)(O,{mode:w,setMode:C}),(0,x.jsx)(b,{})]})]});return n.listStore.loading||M.categoryStore.loading?(0,x.jsx)(E.Z,{}):e.length?(0,x.jsxs)(o.Z,{vertical:!0,gap:32,children:[B,I]}):(0,x.jsx)(u.Z,{image:u.Z.PRESENTED_IMAGE_SIMPLE,description:""})})),w=(0,s.memo)(Y)},6619:(e,t,a)=>{a.d(t,{CH:()=>d,ky:()=>i,ls:()=>c,r6:()=>f,u1:()=>u});var s=a(8418),r=a(7892),n=a.n(r),o=a(6818),l=a.n(o);n().extend(l());const i=(e,t,a,r)=>{const{range:o,categoriesToFilter:l,sortingAlgorithm:i,isSortingReversed:c}=e;return(0,s.M)(t.filter((e=>l.length?e.date.isBetween(n()(o[0]),n()(o[1]),"day","[]")&&l.some((t=>e.category.id===t.id)):e.date.isBetween(n()(o[0]),n()(o[1]),r?"day":"month","[]"))),i,c,a)},c=(e,t)=>{const{currentPage:a,pageSize:s}=e,r=(a-1)*s,n=r+s;return t.slice(r,n)},u=(e,t)=>{const a={};e.forEach((e=>{const s=e.date.year();void 0===a[s]?a[s]=0:a[s]+=e.price[t]}));for(let s in a)a[s]=Math.round(a[s]);return a},d=(e,t,a,s)=>{const r=[];return e.forEach((e=>{if(e.date.isBetween(n()(t[0]),n()(t[1]),s?"day":"month","[]")){const t=r.findIndex((t=>t.category.id===e.category.id));-1!==t?r[t].value+=e.price[a]:r.push({category:e.category,value:e.price[a]})}})),r.map((e=>({...e,value:Math.round(e.value)})))},f=(e,t,a,s)=>Math.floor(e.reduce(((e,r)=>r.date.isBetween(n()(t[0]),n()(t[1]),s?"day":"month","[]")?e+r.price[a]:e),0))},8418:(e,t,a)=>{a.d(t,{M:()=>r,R:()=>s});const s=(e,t)=>{var a;let s="";"USD"===e&&(s+="$"),"EUR"===e&&(s+="\u20ac"),"RUB"===e&&(s+="\u20bd");const r=null===(a=Math.round(t))||void 0===a?void 0:a.toString().split("").reverse().reduce(((e,t,a)=>a%3===0&&0!==a?[...e,t+","]:[...e,t]),[]).reverse().join("");return void 0===t?s:s+r},r=(e,t,a,s)=>{let r;switch(t){case"date":r=[...e].sort(((e,t)=>t.date.valueOf()-e.date.valueOf()));break;case"title":r=[...e].sort(((e,t)=>e.title.localeCompare(t.title,s,{sensitivity:"base"})));break;case"price":r=[...e].sort(((e,t)=>t.price.USD-e.price.USD));break;default:r=[...e]}return a?r.reverse():r}}}]);
//# sourceMappingURL=538.baac4afa.chunk.js.map