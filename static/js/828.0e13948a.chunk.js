"use strict";(self.webpackChunkexpenses_manager=self.webpackChunkexpenses_manager||[]).push([[828],{8537:(e,t,s)=>{s.d(t,{Z:()=>j});var n=s(2791),l=s(7257),r=s(7201),a=s(4248),i=s(7708),o=s(4320),c=s(7892),d=s.n(c),u=s(9026),g=s.n(u),m=s(4895),h=s(4187),p=s(6814),x=s(184);d().extend(g());const j=(0,l.Pi)((e=>{let{range:t,defaultRange:s,setRange:l,setDefaultRange:c,isAccurate:u,setIsAccurate:g}=e;const{list:j}=o.listStore,{isSmallScreen:S}=p.userStore,[v,Z]=(0,n.useState)(s),f=(0,n.useMemo)((()=>{var e,t;const s=j.map((e=>e.date));return[(null===(e=d().min(s))||void 0===e?void 0:e.valueOf())||0,(null===(t=d().max(s))||void 0===t?void 0:t.valueOf())||0]}),[j]),y=(0,n.useMemo)((()=>{const e=d()(f[0]).startOf("month"),t=d()(f[1]).endOf("month"),s={};let n=e;if(u)for(;n.isBefore(t)||n.isSame(t,"day");)s[n.valueOf()]=1===n.date()?0===n.month()?n.format("YYYY"):n.format("M"):" ",n=n.add(1,"day").startOf("day");else for(;n.isBefore(t)||n.isSame(t,"month");)s[n.valueOf()]=0===n.month()?n.format("YYYY"):" ",n=n.add(1,"month").startOf("month");return s}),[f,u]);(0,n.useEffect)((()=>{c(f)}),[f,c]),(0,n.useEffect)((()=>{l(s)}),[s,l]);const C=(0,n.useCallback)((e=>{l(e)}),[l]);return(0,n.useEffect)((()=>{Z(t)}),[t]),(0,n.useEffect)((()=>{S&&g(!1)}),[S,g]),(0,n.useEffect)((()=>{!u&&l([d()(t[0]).startOf("month").valueOf(),d()(t[1]).endOf("month").valueOf()])}),[u]),(0,x.jsxs)(r.Z,{gap:16,children:[(0,x.jsx)(a.Z,{size:S?"small":"middle",defaultValue:u,value:u,onChange:g,options:[{label:(0,x.jsx)(m.Z,{}),value:!1},{label:(0,x.jsx)(h.Z,{}),value:!0,disabled:S}]}),(0,x.jsx)(i.Z,{range:!0,value:v,marks:y,step:null,dots:!0,tooltip:{formatter:e=>(0,x.jsx)(x.Fragment,{children:d()(e).format(u?"DD.MM.YY":"MM.YY")})},min:f[0],max:f[1],defaultValue:s,onChange:Z,onChangeComplete:C,style:{inlineSize:"100%"}})]})}))},3598:(e,t,s)=>{s.d(t,{Z:()=>l});var n=s(2791);const l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250;const[s,l]=(0,n.useState)(e);return(0,n.useEffect)((()=>{const s=setTimeout((()=>{l(e)}),t);return()=>{clearTimeout(s)}}),[e,t]),s}},2828:(e,t,s)=>{s.r(t),s.d(t,{default:()=>me});var n=s(2791),l=s(8418),r=s(6220),a=s(7201),i=s(5160),o=s(1429),c=s(952),d=s(4587),u=s(914),g=s(3936),m=s(7257),h=s(4320),p=s(6814),x=s(2499),j=s(732),S=s(2622),v=s(1752),Z=s(4878);const f=function(e,t){switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:Z.Z.baseCurrency){case"USD":e.EUR=e.USD*t.EUR,e.RUB=e.USD*t.RUB;break;case"EUR":e.USD=e.EUR/t.EUR,e.RUB=e.EUR*t.RUB/t.EUR;break;case"RUB":e.EUR=e.RUB/t.RUB*t.EUR,e.USD=e.RUB/t.RUB}return e};var y=s(3475),C=s(8416),b=s(6005),R=s(1468),k=s(5947),E=s(3070),I=s(6106),O=s(3556),z=s(7892),U=s.n(z),M=s(126),D=s(8228),P=s(184);const w=(0,m.Pi)((e=>{let{value:t,onChange:s}=e;const{categories:n}=y.categoryStore,{isSmallScreen:l}=p.userStore;return(0,P.jsx)(M.Z,{size:l?"small":"middle",allowClear:!0,style:{minInlineSize:"7em"},onChange:s,value:null===t||void 0===t?void 0:t.id,suffixIcon:(0,P.jsx)(D.Z,{style:{color:null===t||void 0===t?void 0:t.color}}),children:n.map((e=>(0,P.jsx)(M.Z.Option,{value:e.id,children:e.name},e.id)))})}));var B=s(7575),A=s(7703);const T=(0,m.Pi)((e=>{let{opened:t,initialItem:s,toggleOpened:l,submitItem:r}=e;const[a,i]=(0,n.useState)(Z.Z.baseCurrency),{categories:o}=y.categoryStore,{currencyRates:c,isSmallScreen:d}=p.userStore,{userOptions:g}=A.optionsStore,{language:m}=g,[h,x]=(0,n.useState)(s),S=(0,n.useCallback)((e=>{const{value:t}=e.target;x((e=>({...e,title:t})))}),[x]),v=(0,n.useCallback)((e=>{e&&x((t=>({...t,date:e})))}),[x]),z=(0,n.useCallback)((e=>{const t=o.find((t=>t.id===e));x((e=>({...e,category:t||e.category})))}),[x,o]),M=(0,n.useCallback)((e=>{const{value:t}=e.target;x((e=>{const s={...e,price:{...e.price,[a]:Number(t)}};return{...s,price:f(s.price,c,a)}}))}),[x,a,c]);(0,n.useEffect)((()=>{const e=s=>{"Enter"===s.key&&t&&(r(h),window.removeEventListener("keyup",e))};return window.addEventListener("keyup",e),()=>{window.removeEventListener("keyup",e)}}),[h,r,t]);const D=(0,P.jsx)(b.Z,{required:!0,type:"text",value:h.title,onInput:S}),T=(0,P.jsx)(b.Z,{required:!0,type:"number",min:"1",step:"1",value:Math.round(h.price[a]),onInput:M}),Y=(0,P.jsx)(O.Z,{value:a,setCurrency:i,onChange:i}),F=(0,P.jsx)(R.Z,{required:!0,onChange:v,value:h.date,minDate:Z.Z.startDate,maxDate:U()()}),L=(0,P.jsx)(w,{value:h.category,onChange:z});return(0,P.jsx)(k.Z,{style:{inlineSize:""},open:t,okButtonProps:{size:d?"small":"middle"},cancelButtonProps:{size:d?"small":"middle"},onOk:()=>{r(h)},onCancel:()=>{x(s),l()},okText:(0,P.jsx)(B.Z,{}),cancelText:(0,P.jsx)(j.Z,{}),children:(0,P.jsxs)(E.Z,{size:d?"small":"middle",layout:"vertical",style:{inlineSize:"100%"},children:[(0,P.jsx)(E.Z.Item,{label:C.Z.title[m],children:D}),(0,P.jsx)(E.Z.Item,{label:C.Z.price[m],children:(0,P.jsxs)(I.Z,{children:[(0,P.jsx)(u.Z,{span:16,children:T}),(0,P.jsx)(u.Z,{span:1}),(0,P.jsx)(u.Z,{span:7,children:Y})]})}),(0,P.jsx)(E.Z.Item,{label:C.Z.dateAndCat[m],children:(0,P.jsxs)(I.Z,{children:[(0,P.jsx)(u.Z,{span:10,children:F}),(0,P.jsx)(u.Z,{span:1}),(0,P.jsx)(u.Z,{span:13,children:L})]})})]})})})),Y=(0,m.Pi)((e=>{let{mode:t,initialItem:s}=e;const{id:m,category:Z,date:f,title:y,price:b}=s,{isSmallScreen:R}=p.userStore,{replaceItem:k,removeItem:E}=h.listStore,{userOptions:I}=A.optionsStore,{currency:O,language:z}=I,[U,M]=(0,n.useState)(!1),[D,w]=(0,n.useState)(0),[B,Y]=(0,n.useState)(!1),[F,L]=(0,n.useState)({id:m,date:f,title:y,category:Z,price:b}),_=()=>{M((e=>!e))};(0,n.useEffect)((()=>{const e=setInterval((()=>{w((e=>{const t=e+10;return t>=I.deleteDelay&&U&&E(F),t}))}),10);return U||(clearInterval(e),w(0)),()=>clearInterval(e)}),[U,F,E,I.deleteDelay]);const q=(0,n.useCallback)((()=>{Y((e=>!e))}),[Y]),N=(0,n.useCallback)((e=>{L(e),k(e),q()}),[L,k,q]),V=(0,P.jsx)(a.Z,{justify:"center",style:{opacity:U||!F.title?".5":"1"},children:R?(0,P.jsx)(i.Z.Text,{strong:!0,ellipsis:!0,children:F.title||C.Z.noTitle[z]}):(0,P.jsx)(x.Z,{ellipsis:!0,level:3,style:{margin:0},children:F.title||C.Z.noTitle[z]})}),G=(0,P.jsx)(o.Z,{value:F.date.format("DD.MM.YY"),style:{scale:R?".75":"1",opacity:U?".5":"1"}}),H=(0,P.jsx)(a.Z,{vertical:!0,align:"stretch",style:{opacity:U?".5":"1"},children:(0,P.jsx)(c.Z,{color:F.category.color,children:(0,P.jsx)("span",{style:{margin:"auto",color:F.category.color,filter:"invert(1)"},children:F.category.name})})}),$=(0,P.jsx)(a.Z,{justify:"center",style:{opacity:U?".5":"1"},children:R?(0,P.jsxs)(i.Z.Text,{strong:!0,children:[(0,l.R)(O),Math.round(F.price[O])]}):(0,P.jsx)(x.Z,{level:3,style:{margin:0},children:(0,l.R)(O,F.price[O])})}),J=U?(0,P.jsx)(j.Z,{onClick:_,style:{scale:R?"1":"1.5"}}):(0,P.jsx)(S.Z,{onClick:_,style:{scale:R?"1":"1.5"}}),K=(0,P.jsx)(d.Z,{showInfo:!1,percent:D/I.deleteDelay*100,status:"exception"}),Q=(0,P.jsx)(v.Z,{onClick:U?()=>{}:()=>N({...s}),style:{scale:R?"1":"1.5"}}),W=(0,P.jsxs)(a.Z,{justify:"space-evenly",children:[Q,$,J]});return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(T,{opened:B,initialItem:F,toggleOpened:q,submitItem:N}),"list"===t?(0,P.jsx)(r.Z,{children:U?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(u.Z,{span:21,children:K}),(0,P.jsx)(u.Z,{children:J})]}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(u.Z,{children:G}),(0,P.jsx)(u.Z,{span:9,children:V}),(0,P.jsx)(u.Z,{span:3,children:H}),(0,P.jsx)(u.Z,{span:5,children:$}),(0,P.jsx)(u.Z,{children:Q}),(0,P.jsx)(u.Z,{children:J})]})}):(0,P.jsx)(g.Z,{size:R?"small":"default",bordered:!0,title:U?K:V,actions:[W],children:(0,P.jsx)(a.Z,{justify:"center",children:(0,P.jsxs)(a.Z,{vertical:!0,align:"stretch",gap:4,children:[G,H]})})})]})}));var F=s(4664),L=s(6051),_=s(6619),q=s(3598),N=s(6281);const V=(0,m.Pi)((e=>{let{filteredList:t}=e;const{loading:s}=h.listStore,{width:l}=p.userStore,{listOptions:r}=A.optionsStore,a=(0,q.Z)(r),[i,o]=(0,n.useState)(4);(0,n.useEffect)((()=>{o(l<350?1:l<450?2:l<850?3:4)}),[o,l]);const c=(0,n.useMemo)((()=>(0,_.ls)(a,t)),[t,a]),d=(0,n.useMemo)((()=>{const e=[];let t=-1;return c.forEach(((s,n)=>{n%i===0&&(t++,e.push([])),e[t].push(s)})),e}),[i,c]);return(0,P.jsxs)(P.Fragment,{children:[s?(0,P.jsx)(N.Z,{}):!t.length&&(0,P.jsx)(F.Z,{image:F.Z.PRESENTED_IMAGE_SIMPLE,description:""}),"list"===a.mode?(0,P.jsx)(L.Z,{style:{inlineSize:"100%"},children:c.map((e=>(0,P.jsx)(Y,{mode:a.mode,initialItem:e},e.id)))}):d.map((e=>(0,P.jsx)(I.Z,{gutter:16,style:{inlineSize:"100%"},children:e.map((e=>(0,P.jsx)(u.Z,{span:24/i,children:(0,P.jsx)(Y,{mode:a.mode,initialItem:e})},e.id)))},e[0].id)))]})})),G=(0,n.memo)(V);var H=s(2556),$=s(7128),J=s(6834),K=s(9286);const Q=(0,m.Pi)((()=>{const{addItem:e}=h.listStore,{isSmallScreen:t}=p.userStore,s=(0,n.useMemo)((()=>Z.Z.emptyItem),[]),[l,r]=(0,n.useState)(s),[a,i]=(0,n.useState)(!1),o=(0,n.useCallback)((()=>{i((e=>!e))}),[i]),c=(0,n.useCallback)((()=>{r(s)}),[r,s]),d=(0,n.useCallback)((t=>{e(t),c(),o()}),[e,o,c]);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(H.ZP,{onClick:o,size:t?"small":"middle",children:(0,P.jsx)(K.Z,{})}),(0,P.jsx)(T,{opened:a,initialItem:l,toggleOpened:o,submitItem:d})]})}));var W=s(8537);const X=(0,m.Pi)((()=>{const{categories:e}=y.categoryStore,{isSmallScreen:t}=p.userStore,{listOptions:s,handleCategoriesToFilterChange:n}=A.optionsStore;return(0,P.jsx)(M.Z,{size:t?"small":"middle",mode:"multiple",showSearch:!1,tagRender:t=>((e,t)=>{var s;const{label:n,value:l,onClose:r}=e,a=null===(s=t.find((e=>e.id===l)))||void 0===s?void 0:s.color;return(0,P.jsx)(c.Z,{color:a,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},closable:!0,onClose:r,style:{marginInlineEnd:4},children:(0,P.jsx)("span",{style:{color:a,filter:"invert(1)"},children:n})})})(t,e),style:{minInlineSize:"10em"},value:s.categoriesToFilter.map((e=>e.id)),onChange:n,children:e.map((e=>(0,P.jsx)(M.Z.Option,{value:e.id,children:e.name},e.id)))})}));var ee=s(4248),te=s(4544),se=s(54),ne=s(9168),le=s(2785),re=s(897);const ae=(0,m.Pi)((()=>{const{isSmallScreen:e}=p.userStore,{setIsSortingReversed:t,listOptions:s,handleSortAlgorithmChanging:n}=A.optionsStore;return(0,P.jsxs)(a.Z,{gap:8,style:{alignSelf:"start"},children:[s.isSortingReversed?(0,P.jsx)(te.Z,{}):(0,P.jsx)(se.Z,{}),(0,P.jsx)(ee.Z,{size:e?"small":"middle",value:s.sortingAlgorithm,onDoubleClick:()=>t(!s.isSortingReversed),onChange:n,options:[{label:(0,P.jsx)(ne.Z,{}),value:"date"},{label:(0,P.jsx)(le.Z,{}),value:"title"},{label:(0,P.jsx)(re.Z,{}),value:"price"}]})]})}));var ie=s(6324),oe=s(9197);const ce=(0,m.Pi)((()=>{const{isSmallScreen:e}=p.userStore,{listOptions:t,handleModeChanging:s}=A.optionsStore;return(0,P.jsx)(a.Z,{gap:8,style:{alignSelf:"start"},children:(0,P.jsx)(ee.Z,{size:e?"small":"middle",value:t.mode,onChange:s,options:[{label:(0,P.jsx)(ie.Z,{}),value:"list",disabled:e},{label:(0,P.jsx)(oe.Z,{}),value:"grid"}]})})}));var de=s(3605);const ue=(0,m.Pi)((e=>{let{total:t}=e;const{loading:s}=h.listStore,{isSmallScreen:l}=p.userStore,{listOptions:r,resetSettings:i,handlePageChanging:o,setRange:c,setDefaultRange:d,setIsAccurate:u}=A.optionsStore,{isSortingReversed:g,range:m,defaultRange:x,categoriesToFilter:j,pageSize:S,currentPage:v,sortingAlgorithm:f,isAccurate:y}=r,C=(0,n.useMemo)((()=>g||j.length>0||S!==Z.Z.defaultPageSize||1!==v||m[0]&&m[1]&&(m[0]!==x[0]||m[1])!==x[1]||"date"!==f),[m,x,g,j,S,v,f]);return(0,P.jsxs)(a.Z,{vertical:!0,style:{inlineSize:"100%"},children:[(0,P.jsxs)(a.Z,{vertical:!0,gap:32,children:[(0,P.jsxs)(a.Z,{gap:16,vertical:l,children:[(0,P.jsxs)(a.Z,{gap:16,children:[(0,P.jsx)(Q,{}),(0,P.jsx)(X,{})]}),(0,P.jsxs)(a.Z,{gap:16,children:[(0,P.jsx)(ae,{}),(0,P.jsx)(ce,{}),(0,P.jsx)(H.ZP,{disabled:!C,onClick:i,size:l?"small":"middle",children:(0,P.jsx)(de.Z,{})})]})]}),!s&&(0,P.jsx)(W.Z,{setIsAccurate:u,isAccurate:y,range:m,defaultRange:x,setRange:c,setDefaultRange:d})]}),(0,P.jsx)($.Z,{}),!s&&(0,P.jsx)(J.Z,{style:{alignSelf:"center"},size:l?"small":"default",showSizeChanger:!0,pageSizeOptions:Z.Z.pageSizeOptions,current:r.currentPage,pageSize:r.pageSize,total:t,onChange:o,onShowSizeChange:o})]})})),ge=(0,m.Pi)((()=>{const{isSmallScreen:e}=p.userStore,{list:t}=h.listStore,{listOptions:s,userOptions:l,handleModeChanging:r,handlePageChanging:i}=A.optionsStore,{language:o}=l,{range:c,sortingAlgorithm:d,isSortingReversed:u,categoriesToFilter:g,pageSize:m,isAccurate:x}=s;(0,n.useEffect)((()=>{e&&r("grid")}),[e,r]),(0,n.useEffect)((()=>{i(1,m)}),[c,d,u,g,m,i]);const j=(0,n.useMemo)((()=>(0,_.ky)(s,t,o,x)),[t,o,s,x]);return(0,P.jsxs)(a.Z,{vertical:!0,gap:16,align:"center",children:[(0,P.jsx)(ue,{total:j.length}),(0,P.jsx)(G,{filteredList:j})]})})),me=ge},6619:(e,t,s)=>{s.d(t,{CH:()=>u,ky:()=>o,ls:()=>c,r6:()=>g,u1:()=>d});var n=s(8418),l=s(7892),r=s.n(l),a=s(6818),i=s.n(a);r().extend(i());const o=(e,t,s,l)=>{const{range:a,categoriesToFilter:i,sortingAlgorithm:o,isSortingReversed:c}=e;return(0,n.M)(t.filter((e=>i.length?e.date.isBetween(r()(a[0]),r()(a[1]),"day","[]")&&i.some((t=>e.category.id===t.id)):e.date.isBetween(r()(a[0]),r()(a[1]),l?"day":"month","[]"))),o,c,s)},c=(e,t)=>{const{currentPage:s,pageSize:n}=e,l=(s-1)*n,r=l+n;return t.slice(l,r)},d=(e,t)=>{const s={};e.forEach((e=>{const n=e.date.year();void 0===s[n]?s[n]=0:s[n]+=e.price[t]}));for(let n in s)s[n]=Math.round(s[n]);return s},u=(e,t,s,n)=>{const l=[];return e.forEach((e=>{if(e.date.isBetween(r()(t[0]),r()(t[1]),n?"day":"month","[]")){const t=l.findIndex((t=>t.category.id===e.category.id));-1!==t?l[t].value+=e.price[s]:l.push({category:e.category,value:e.price[s]})}})),l.map((e=>({...e,value:Math.round(e.value)})))},g=(e,t,s,n)=>Math.floor(e.reduce(((e,l)=>l.date.isBetween(r()(t[0]),r()(t[1]),n?"day":"month","[]")?e+l.price[s]:e),0))},8418:(e,t,s)=>{s.d(t,{M:()=>l,R:()=>n});const n=(e,t)=>{var s;let n="";"USD"===e&&(n+="$"),"EUR"===e&&(n+="\u20ac"),"RUB"===e&&(n+="\u20bd");const l=null===(s=Math.round(t))||void 0===s?void 0:s.toString().split("").reverse().reduce(((e,t,s)=>s%3===0&&0!==s?[...e,t+","]:[...e,t]),[]).reverse().join("");return void 0===t?n:n+l},l=(e,t,s,n)=>{let l;switch(t){case"date":l=[...e].sort(((e,t)=>t.date.valueOf()-e.date.valueOf()));break;case"title":l=[...e].sort(((e,t)=>e.title.localeCompare(t.title,n,{sensitivity:"base"})));break;case"price":l=[...e].sort(((e,t)=>t.price.USD-e.price.USD));break;default:l=[...e]}return s?l.reverse():l}}}]);
//# sourceMappingURL=828.0e13948a.chunk.js.map